# Test on A100

| count | batch_size | in_features | out_features | main_centroids | residual_centroids | vptq (ms) | torch (ms) | ratio |
| ----- | ---------- | ----------- | ------------ | -------------- | ------------------ | --------- | ---------- | ----- |
| 1     | 1          | 1024        | 1024         | 4096           | 256                | 0.0243    | 0.0265     | 0.92  |
| 2     | 1          | 2048        | 1024         | 4096           | 256                | 0.0255    | 0.0301     | 0.85  |
| 3     | 1          | 4096        | 1024         | 4096           | 256                | 0.0304    | 0.0316     | 0.96  |
| 4     | 1          | 8192        | 1024         | 4096           | 256                | 0.0382    | 0.0315     | 1.21  |
| 5     | 1          | 16384       | 1024         | 4096           | 256                | 0.0525    | 0.0382     | 1.37  |
| 6     | 1          | 1024        | 4096         | 4096           | 256                | 0.0449    | 0.0296     | 1.52  |
| 7     | 1          | 2048        | 4096         | 4096           | 256                | 0.0502    | 0.0278     | 1.81  |
| 8     | 1          | 4096        | 4096         | 4096           | 256                | 0.0606    | 0.0367     | 1.65  |
| 9     | 1          | 8192        | 4096         | 4096           | 256                | 0.0815    | 0.0654     | 1.25  |
| 10    | 1          | 16384       | 4096         | 4096           | 256                | 0.1294    | 0.1094     | 1.18  |
| 11    | 1          | 1024        | 8192         | 4096           | 256                | 0.0628    | 0.0289     | 2.17  |
| 12    | 1          | 2048        | 8192         | 4096           | 256                | 0.0729    | 0.0341     | 2.14  |
| 13    | 1          | 4096        | 8192         | 4096           | 256                | 0.0925    | 0.0627     | 1.48  |
| 14    | 1          | 8192        | 8192         | 4096           | 256                | 0.1304    | 0.1062     | 1.23  |
| 15    | 1          | 16384       | 8192         | 4096           | 256                | 0.2356    | 0.1945     | 1.21  |
| 16    | 1          | 1024        | 14336        | 4096           | 256                | 0.0917    | 0.0337     | 2.72  |
| 17    | 1          | 2048        | 14336        | 4096           | 256                | 0.1134    | 0.0622     | 1.82  |
| 18    | 1          | 4096        | 14336        | 4096           | 256                | 0.1468    | 0.1003     | 1.46  |
| 19    | 1          | 8192        | 14336        | 4096           | 256                | 0.2393    | 0.1711     | 1.40  |
| 20    | 1          | 16384       | 14336        | 4096           | 256                | 0.4039    | 0.3194     | 1.26  |
| 21    | 1          | 1024        | 28672        | 4096           | 256                | 0.1585    | 0.0625     | 2.54  |
| 22    | 1          | 2048        | 28672        | 4096           | 256                | 0.2014    | 0.1016     | 1.98  |
| 23    | 1          | 4096        | 28672        | 4096           | 256                | 0.2789    | 0.1703     | 1.64  |
| 24    | 1          | 8192        | 28672        | 4096           | 256                | 0.4421    | 0.3190     | 1.39  |
| 25    | 1          | 16384       | 28672        | 4096           | 256                | 0.7548    | 0.5970     | 1.26  |
| 26    | 1          | 1024        | 53248        | 4096           | 256                | 0.2702    | 0.0899     | 3.01  |
| 27    | 1          | 2048        | 53248        | 4096           | 256                | 0.3477    | 0.1531     | 2.27  |
| 28    | 1          | 4096        | 53248        | 4096           | 256                | 0.4965    | 0.2793     | 1.78  |
| 29    | 1          | 8192        | 53248        | 4096           | 256                | 0.7943    | 0.5920     | 1.34  |
| 30    | 1          | 16384       | 53248        | 4096           | 256                | 1.3697    | 1.1349     | 1.21  |
| 31    | 1          | 1024        | 1024         | 8192           | 256                | 0.0311    | 0.0260     | 1.20  |
| 32    | 1          | 2048        | 1024         | 8192           | 256                | 0.0345    | 0.0271     | 1.28  |
| 33    | 1          | 4096        | 1024         | 8192           | 256                | 0.0407    | 0.0305     | 1.34  |
| 34    | 1          | 8192        | 1024         | 8192           | 256                | 0.0510    | 0.0309     | 1.65  |
| 35    | 1          | 16384       | 1024         | 8192           | 256                | 0.0750    | 0.0368     | 2.04  |
| 36    | 1          | 1024        | 4096         | 8192           | 256                | 0.0646    | 0.0279     | 2.31  |
| 37    | 1          | 2048        | 4096         | 8192           | 256                | 0.0722    | 0.0269     | 2.68  |
| 38    | 1          | 4096        | 4096         | 8192           | 256                | 0.0864    | 0.0362     | 2.38  |
| 39    | 1          | 8192        | 4096         | 8192           | 256                | 0.1106    | 0.0655     | 1.69  |
| 40    | 1          | 16384       | 4096         | 8192           | 256                | 0.1691    | 0.1098     | 1.54  |
| 41    | 1          | 1024        | 8192         | 8192           | 256                | 0.1077    | 0.0271     | 3.97  |
| 42    | 1          | 2048        | 8192         | 8192           | 256                | 0.1224    | 0.0372     | 3.29  |
| 43    | 1          | 4096        | 8192         | 8192           | 256                | 0.1532    | 0.0642     | 2.39  |
| 44    | 1          | 8192        | 8192         | 8192           | 256                | 0.2057    | 0.1085     | 1.90  |
| 45    | 1          | 16384       | 8192         | 8192           | 256                | 0.3968    | 0.1949     | 2.04  |
| 46    | 1          | 1024        | 14336        | 8192           | 256                | 0.1697    | 0.0330     | 5.14  |
| 47    | 1          | 2048        | 14336        | 8192           | 256                | 0.1981    | 0.0628     | 3.16  |
| 48    | 1          | 4096        | 14336        | 8192           | 256                | 0.2502    | 0.1008     | 2.48  |
| 49    | 1          | 8192        | 14336        | 8192           | 256                | 0.3985    | 0.1712     | 2.33  |
| 50    | 1          | 16384       | 14336        | 8192           | 256                | 0.6628    | 0.3196     | 2.07  |
| 51    | 1          | 1024        | 28672        | 8192           | 256                | 0.3151    | 0.0633     | 4.98  |
| 52    | 1          | 2048        | 28672        | 8192           | 256                | 0.3710    | 0.1021     | 3.64  |
| 53    | 1          | 4096        | 28672        | 8192           | 256                | 0.5059    | 0.1706     | 2.96  |
| 54    | 1          | 8192        | 28672        | 8192           | 256                | 0.7682    | 0.3174     | 2.42  |
| 55    | 1          | 16384       | 28672        | 8192           | 256                | 1.2991    | 0.5977     | 2.17  |
| 56    | 1          | 1024        | 53248        | 8192           | 256                | 0.5617    | 0.0902     | 6.23  |
| 57    | 1          | 2048        | 53248        | 8192           | 256                | 0.6777    | 0.1531     | 4.43  |
| 58    | 1          | 4096        | 53248        | 8192           | 256                | 0.9152    | 0.2797     | 3.27  |
| 59    | 1          | 8192        | 53248        | 8192           | 256                | 1.4040    | 0.5915     | 2.37  |
| 60    | 1          | 16384       | 53248        | 8192           | 256                | 2.3799    | 1.1346     | 2.10  |
| 61    | 1          | 1024        | 1024         | 4096           | 512                | 0.0247    | 0.0282     | 0.88  |
| 62    | 1          | 2048        | 1024         | 4096           | 512                | 0.0259    | 0.0257     | 1.01  |
| 63    | 1          | 4096        | 1024         | 4096           | 512                | 0.0282    | 0.0292     | 0.97  |
| 64    | 1          | 8192        | 1024         | 4096           | 512                | 0.0336    | 0.0319     | 1.05  |
| 65    | 1          | 16384       | 1024         | 4096           | 512                | 0.0448    | 0.0365     | 1.23  |
| 66    | 1          | 1024        | 4096         | 4096           | 512                | 0.0447    | 0.0277     | 1.61  |
| 67    | 1          | 2048        | 4096         | 4096           | 512                | 0.0479    | 0.0297     | 1.61  |
| 68    | 1          | 4096        | 4096         | 4096           | 512                | 0.0566    | 0.0365     | 1.55  |
| 69    | 1          | 8192        | 4096         | 4096           | 512                | 0.0719    | 0.0655     | 1.10  |
| 70    | 1          | 16384       | 4096         | 4096           | 512                | 0.1291    | 0.1096     | 1.18  |
| 71    | 1          | 1024        | 8192         | 4096           | 512                | 0.0639    | 0.0297     | 2.15  |
| 72    | 1          | 2048        | 8192         | 4096           | 512                | 0.0723    | 0.0369     | 1.96  |
| 73    | 1          | 4096        | 8192         | 4096           | 512                | 0.0860    | 0.0631     | 1.36  |
| 74    | 1          | 8192        | 8192         | 4096           | 512                | 0.1283    | 0.1067     | 1.20  |
| 75    | 1          | 16384       | 8192         | 4096           | 512                | 0.2105    | 0.1943     | 1.08  |
| 76    | 1          | 1024        | 14336        | 4096           | 512                | 0.0936    | 0.0345     | 2.71  |
| 77    | 1          | 2048        | 14336        | 4096           | 512                | 0.1120    | 0.0632     | 1.77  |
| 78    | 1          | 4096        | 14336        | 4096           | 512                | 0.1370    | 0.1007     | 1.36  |
| 79    | 1          | 8192        | 14336        | 4096           | 512                | 0.2163    | 0.1708     | 1.27  |
| 80    | 1          | 16384       | 14336        | 4096           | 512                | 0.3556    | 0.3200     | 1.11  |
| 81    | 1          | 1024        | 28672        | 4096           | 512                | 0.1593    | 0.0649     | 2.45  |
| 82    | 1          | 2048        | 28672        | 4096           | 512                | 0.1995    | 0.1036     | 1.93  |
| 83    | 1          | 4096        | 28672        | 4096           | 512                | 0.2641    | 0.1711     | 1.54  |
| 84    | 1          | 8192        | 28672        | 4096           | 512                | 0.3952    | 0.3175     | 1.24  |
| 85    | 1          | 16384       | 28672        | 4096           | 512                | 0.6557    | 0.5971     | 1.10  |
| 86    | 1          | 1024        | 53248        | 4096           | 512                | 0.2702    | 0.0918     | 2.94  |
| 87    | 1          | 2048        | 53248        | 4096           | 512                | 0.3422    | 0.1528     | 2.24  |
| 88    | 1          | 4096        | 53248        | 4096           | 512                | 0.4607    | 0.2794     | 1.65  |
| 89    | 1          | 8192        | 53248        | 4096           | 512                | 0.7070    | 0.5886     | 1.20  |
| 90    | 1          | 16384       | 53248        | 4096           | 512                | 1.1913    | 1.1355     | 1.05  |
| 91    | 1          | 1024        | 1024         | 8192           | 512                | 0.0300    | 0.0284     | 1.05  |
| 92    | 1          | 2048        | 1024         | 8192           | 512                | 0.0339    | 0.0281     | 1.21  |
| 93    | 1          | 4096        | 1024         | 8192           | 512                | 0.0387    | 0.0324     | 1.20  |
| 94    | 1          | 8192        | 1024         | 8192           | 512                | 0.0489    | 0.0309     | 1.58  |
| 95    | 1          | 16384       | 1024         | 8192           | 512                | 0.0688    | 0.0375     | 1.83  |
| 96    | 1          | 1024        | 4096         | 8192           | 512                | 0.0636    | 0.0280     | 2.27  |
| 97    | 1          | 2048        | 4096         | 8192           | 512                | 0.0715    | 0.0270     | 2.65  |
| 98    | 1          | 4096        | 4096         | 8192           | 512                | 0.0829    | 0.0364     | 2.28  |
| 99    | 1          | 8192        | 4096         | 8192           | 512                | 0.1015    | 0.0662     | 1.53  |
| 100   | 1          | 16384       | 4096         | 8192           | 512                | 0.1911    | 0.1104     | 1.73  |
| 101   | 1          | 1024        | 8192         | 8192           | 512                | 0.1061    | 0.0293     | 3.62  |
| 102   | 1          | 2048        | 8192         | 8192           | 512                | 0.1231    | 0.0355     | 3.47  |
| 103   | 1          | 4096        | 8192         | 8192           | 512                | 0.1463    | 0.0619     | 2.36  |
| 104   | 1          | 8192        | 8192         | 8192           | 512                | 0.2194    | 0.1072     | 2.05  |
| 105   | 1          | 16384       | 8192         | 8192           | 512                | 0.3687    | 0.1938     | 1.90  |
| 106   | 1          | 1024        | 14336        | 8192           | 512                | 0.1681    | 0.0329     | 5.11  |
| 107   | 1          | 2048        | 14336        | 8192           | 512                | 0.1985    | 0.0630     | 3.15  |
| 108   | 1          | 4096        | 14336        | 8192           | 512                | 0.2348    | 0.1003     | 2.34  |
| 109   | 1          | 8192        | 14336        | 8192           | 512                | 0.3722    | 0.1714     | 2.17  |
| 110   | 1          | 16384       | 14336        | 8192           | 512                | 0.6183    | 0.3196     | 1.93  |
| 111   | 1          | 1024        | 28672        | 8192           | 512                | 0.3125    | 0.0655     | 4.77  |
| 112   | 1          | 2048        | 28672        | 8192           | 512                | 0.3801    | 0.1023     | 3.71  |
| 113   | 1          | 4096        | 28672        | 8192           | 512                | 0.4986    | 0.1716     | 2.91  |
| 114   | 1          | 8192        | 28672        | 8192           | 512                | 0.7219    | 0.3174     | 2.27  |
| 115   | 1          | 16384       | 28672        | 8192           | 512                | 1.2136    | 0.5979     | 2.03  |
| 116   | 1          | 1024        | 53248        | 8192           | 512                | 0.5542    | 0.0908     | 6.10  |
| 117   | 1          | 2048        | 53248        | 8192           | 512                | 0.7173    | 0.1536     | 4.67  |
| 118   | 1          | 4096        | 53248        | 8192           | 512                | 0.9008    | 0.2799     | 3.22  |
| 119   | 1          | 8192        | 53248        | 8192           | 512                | 1.3091    | 0.5884     | 2.23  |
| 120   | 1          | 16384       | 53248        | 8192           | 512                | 2.2197    | 1.1339     | 1.96  |
