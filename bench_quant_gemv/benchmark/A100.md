# Test on A100

| count | batch_size | in_features | out_features | main_centroids | residual_centroids | vptq (ms) | torch (ms) | ratio |
| ----- | ---------- | ----------- | ------------ | -------------- | ------------------ | --------- | ---------- | ----- |
| 1     | 1          | 1024        | 1024         | 4096           | 256                | 0.0248    | 0.0245     | 1.01  |
| 2     | 1          | 2048        | 1024         | 4096           | 256                | 0.0283    | 0.0245     | 1.15  |
| 3     | 1          | 4096        | 1024         | 4096           | 256                | 0.0321    | 0.0311     | 1.03  |
| 4     | 1          | 8192        | 1024         | 4096           | 256                | 0.0402    | 0.0289     | 1.39  |
| 5     | 1          | 16384       | 1024         | 4096           | 256                | 0.0565    | 0.0376     | 1.50  |
| 6     | 1          | 1024        | 4096         | 4096           | 256                | 0.0448    | 0.0267     | 1.68  |
| 7     | 1          | 2048        | 4096         | 4096           | 256                | 0.0514    | 0.0259     | 1.99  |
| 8     | 1          | 4096        | 4096         | 4096           | 256                | 0.0618    | 0.0339     | 1.83  |
| 9     | 1          | 8192        | 4096         | 4096           | 256                | 0.0835    | 0.0644     | 1.30  |
| 10    | 1          | 16384       | 4096         | 4096           | 256                | 0.1340    | 0.1079     | 1.24  |
| 11    | 1          | 1024        | 8192         | 4096           | 256                | 0.0642    | 0.0264     | 2.43  |
| 12    | 1          | 2048        | 8192         | 4096           | 256                | 0.0733    | 0.0350     | 2.10  |
| 13    | 1          | 4096        | 8192         | 4096           | 256                | 0.0921    | 0.0615     | 1.50  |
| 14    | 1          | 8192        | 8192         | 4096           | 256                | 0.1330    | 0.1061     | 1.25  |
| 15    | 1          | 16384       | 8192         | 4096           | 256                | 0.2507    | 0.1939     | 1.29  |
| 16    | 1          | 1024        | 14336        | 4096           | 256                | 0.0902    | 0.0329     | 2.74  |
| 17    | 1          | 2048        | 14336        | 4096           | 256                | 0.1131    | 0.0627     | 1.80  |
| 18    | 1          | 4096        | 14336        | 4096           | 256                | 0.1475    | 0.0993     | 1.49  |
| 19    | 1          | 8192        | 14336        | 4096           | 256                | 0.2466    | 0.1700     | 1.45  |
| 20    | 1          | 16384       | 14336        | 4096           | 256                | 0.4266    | 0.3189     | 1.34  |
| 21    | 1          | 1024        | 28672        | 4096           | 256                | 0.1529    | 0.0618     | 2.48  |
| 22    | 1          | 2048        | 28672        | 4096           | 256                | 0.1995    | 0.1007     | 1.98  |
| 23    | 1          | 4096        | 28672        | 4096           | 256                | 0.2808    | 0.1692     | 1.66  |
| 24    | 1          | 8192        | 28672        | 4096           | 256                | 0.4551    | 0.3165     | 1.44  |
| 25    | 1          | 16384       | 28672        | 4096           | 256                | 0.7953    | 0.5959     | 1.33  |
| 26    | 1          | 1024        | 53248        | 4096           | 256                | 0.2610    | 0.0889     | 2.94  |
| 27    | 1          | 2048        | 53248        | 4096           | 256                | 0.3400    | 0.1515     | 2.24  |
| 28    | 1          | 4096        | 53248        | 4096           | 256                | 0.4980    | 0.2790     | 1.79  |
| 29    | 1          | 8192        | 53248        | 4096           | 256                | 0.8174    | 0.5884     | 1.39  |
| 30    | 1          | 16384       | 53248        | 4096           | 256                | 1.4418    | 1.1344     | 1.27  |
| 31    | 1          | 1024        | 1024         | 8192           | 256                | 0.0332    | 0.0271     | 1.23  |
| 32    | 1          | 2048        | 1024         | 8192           | 256                | 0.0349    | 0.0289     | 1.21  |
| 33    | 1          | 4096        | 1024         | 8192           | 256                | 0.0429    | 0.0281     | 1.53  |
| 34    | 1          | 8192        | 1024         | 8192           | 256                | 0.0546    | 0.0290     | 1.88  |
| 35    | 1          | 16384       | 1024         | 8192           | 256                | 0.0782    | 0.0373     | 2.10  |
| 36    | 1          | 1024        | 4096         | 8192           | 256                | 0.0655    | 0.0251     | 2.61  |
| 37    | 1          | 2048        | 4096         | 8192           | 256                | 0.0727    | 0.0274     | 2.66  |
| 38    | 1          | 4096        | 4096         | 8192           | 256                | 0.0864    | 0.0342     | 2.53  |
| 39    | 1          | 8192        | 4096         | 8192           | 256                | 0.1149    | 0.0639     | 1.80  |
| 40    | 1          | 16384       | 4096         | 8192           | 256                | 0.1757    | 0.1093     | 1.61  |
| 41    | 1          | 1024        | 8192         | 8192           | 256                | 0.1104    | 0.0309     | 3.58  |
| 42    | 1          | 2048        | 8192         | 8192           | 256                | 0.1241    | 0.0363     | 3.42  |
| 43    | 1          | 4096        | 8192         | 8192           | 256                | 0.1543    | 0.0633     | 2.44  |
| 44    | 1          | 8192        | 8192         | 8192           | 256                | 0.2106    | 0.1071     | 1.97  |
| 45    | 1          | 16384       | 8192         | 8192           | 256                | 0.4059    | 0.1933     | 2.10  |
| 46    | 1          | 1024        | 14336        | 8192           | 256                | 0.1686    | 0.0324     | 5.20  |
| 47    | 1          | 2048        | 14336        | 8192           | 256                | 0.1983    | 0.0618     | 3.21  |
| 48    | 1          | 4096        | 14336        | 8192           | 256                | 0.2492    | 0.0989     | 2.52  |
| 49    | 1          | 8192        | 14336        | 8192           | 256                | 0.4069    | 0.1704     | 2.39  |
| 50    | 1          | 16384       | 14336        | 8192           | 256                | 0.6774    | 0.3189     | 2.12  |
| 51    | 1          | 1024        | 28672        | 8192           | 256                | 0.3117    | 0.0624     | 5.00  |
| 52    | 1          | 2048        | 28672        | 8192           | 256                | 0.3698    | 0.1014     | 3.65  |
| 53    | 1          | 4096        | 28672        | 8192           | 256                | 0.5091    | 0.1708     | 2.98  |
| 54    | 1          | 8192        | 28672        | 8192           | 256                | 0.7800    | 0.3168     | 2.46  |
| 55    | 1          | 16384       | 28672        | 8192           | 256                | 1.3268    | 0.5976     | 2.22  |
| 56    | 1          | 1024        | 53248        | 8192           | 256                | 0.5568    | 0.0890     | 6.26  |
| 57    | 1          | 2048        | 53248        | 8192           | 256                | 0.6765    | 0.1519     | 4.45  |
| 58    | 1          | 4096        | 53248        | 8192           | 256                | 0.9202    | 0.2789     | 3.30  |
| 59    | 1          | 8192        | 53248        | 8192           | 256                | 1.4292    | 0.5884     | 2.43  |
| 60    | 1          | 16384       | 53248        | 8192           | 256                | 2.4250    | 1.1339     | 2.14  |
| 61    | 1          | 1024        | 1024         | 4096           | 512                | 0.0260    | 0.0243     | 1.07  |
| 62    | 1          | 2048        | 1024         | 4096           | 512                | 0.0259    | 0.0261     | 0.99  |
| 63    | 1          | 4096        | 1024         | 4096           | 512                | 0.0293    | 0.0294     | 1.00  |
| 64    | 1          | 8192        | 1024         | 4096           | 512                | 0.0353    | 0.0303     | 1.17  |
| 65    | 1          | 16384       | 1024         | 4096           | 512                | 0.0466    | 0.0366     | 1.27  |
| 66    | 1          | 1024        | 4096         | 4096           | 512                | 0.0452    | 0.0264     | 1.71  |
| 67    | 1          | 2048        | 4096         | 4096           | 512                | 0.0487    | 0.0265     | 1.84  |
| 68    | 1          | 4096        | 4096         | 4096           | 512                | 0.0581    | 0.0349     | 1.66  |
| 69    | 1          | 8192        | 4096         | 4096           | 512                | 0.0732    | 0.0642     | 1.14  |
| 70    | 1          | 16384       | 4096         | 4096           | 512                | 0.1313    | 0.1087     | 1.21  |
| 71    | 1          | 1024        | 8192         | 4096           | 512                | 0.0640    | 0.0272     | 2.35  |
| 72    | 1          | 2048        | 8192         | 4096           | 512                | 0.0734    | 0.0340     | 2.16  |
| 73    | 1          | 4096        | 8192         | 4096           | 512                | 0.0861    | 0.0608     | 1.42  |
| 74    | 1          | 8192        | 8192         | 4096           | 512                | 0.1294    | 0.1061     | 1.22  |
| 75    | 1          | 16384       | 8192         | 4096           | 512                | 0.2133    | 0.1928     | 1.11  |
| 76    | 1          | 1024        | 14336        | 4096           | 512                | 0.0923    | 0.0329     | 2.81  |
| 77    | 1          | 2048        | 14336        | 4096           | 512                | 0.1113    | 0.0626     | 1.78  |
| 78    | 1          | 4096        | 14336        | 4096           | 512                | 0.1364    | 0.1000     | 1.36  |
| 79    | 1          | 8192        | 14336        | 4096           | 512                | 0.2169    | 0.1705     | 1.27  |
| 80    | 1          | 16384       | 14336        | 4096           | 512                | 0.3578    | 0.3194     | 1.12  |
| 81    | 1          | 1024        | 28672        | 4096           | 512                | 0.1567    | 0.0633     | 2.47  |
| 82    | 1          | 2048        | 28672        | 4096           | 512                | 0.1966    | 0.1017     | 1.93  |
| 83    | 1          | 4096        | 28672        | 4096           | 512                | 0.2631    | 0.1704     | 1.54  |
| 84    | 1          | 8192        | 28672        | 4096           | 512                | 0.3955    | 0.3172     | 1.25  |
| 85    | 1          | 16384       | 28672        | 4096           | 512                | 0.6608    | 0.5958     | 1.11  |
| 86    | 1          | 1024        | 53248        | 4096           | 512                | 0.2625    | 0.0888     | 2.96  |
| 87    | 1          | 2048        | 53248        | 4096           | 512                | 0.3360    | 0.1515     | 2.22  |
| 88    | 1          | 4096        | 53248        | 4096           | 512                | 0.4571    | 0.2786     | 1.64  |
| 89    | 1          | 8192        | 53248        | 4096           | 512                | 0.7053    | 0.5892     | 1.20  |
| 90    | 1          | 16384       | 53248        | 4096           | 512                | 1.1934    | 1.1340     | 1.05  |
| 91    | 1          | 1024        | 1024         | 8192           | 512                | 0.0327    | 0.0259     | 1.26  |
| 92    | 1          | 2048        | 1024         | 8192           | 512                | 0.0350    | 0.0280     | 1.25  |
| 93    | 1          | 4096        | 1024         | 8192           | 512                | 0.0413    | 0.0302     | 1.37  |
| 94    | 1          | 8192        | 1024         | 8192           | 512                | 0.0499    | 0.0285     | 1.75  |
| 95    | 1          | 16384       | 1024         | 8192           | 512                | 0.0700    | 0.0374     | 1.87  |
| 96    | 1          | 1024        | 4096         | 8192           | 512                | 0.0645    | 0.0271     | 2.37  |
| 97    | 1          | 2048        | 4096         | 8192           | 512                | 0.0713    | 0.0279     | 2.55  |
| 98    | 1          | 4096        | 4096         | 8192           | 512                | 0.0827    | 0.0355     | 2.33  |
| 99    | 1          | 8192        | 4096         | 8192           | 512                | 0.1025    | 0.0638     | 1.61  |
| 100   | 1          | 16384       | 4096         | 8192           | 512                | 0.1929    | 0.1078     | 1.79  |
| 101   | 1          | 1024        | 8192         | 8192           | 512                | 0.1056    | 0.0275     | 3.84  |
| 102   | 1          | 2048        | 8192         | 8192           | 512                | 0.1220    | 0.0358     | 3.41  |
| 103   | 1          | 4096        | 8192         | 8192           | 512                | 0.1466    | 0.0617     | 2.38  |
| 104   | 1          | 8192        | 8192         | 8192           | 512                | 0.2204    | 0.1071     | 2.06  |
| 105   | 1          | 16384       | 8192         | 8192           | 512                | 0.3696    | 0.1949     | 1.90  |
| 106   | 1          | 1024        | 14336        | 8192           | 512                | 0.1666    | 0.0350     | 4.76  |
| 107   | 1          | 2048        | 14336        | 8192           | 512                | 0.1964    | 0.0634     | 3.10  |
| 108   | 1          | 4096        | 14336        | 8192           | 512                | 0.2345    | 0.1007     | 2.33  |
| 109   | 1          | 8192        | 14336        | 8192           | 512                | 0.3734    | 0.1703     | 2.19  |
| 110   | 1          | 16384       | 14336        | 8192           | 512                | 0.6173    | 0.3201     | 1.93  |
| 111   | 1          | 1024        | 28672        | 8192           | 512                | 0.3062    | 0.0639     | 4.79  |
| 112   | 1          | 2048        | 28672        | 8192           | 512                | 0.3726    | 0.1013     | 3.68  |
| 113   | 1          | 4096        | 28672        | 8192           | 512                | 0.4979    | 0.1701     | 2.93  |
| 114   | 1          | 8192        | 28672        | 8192           | 512                | 0.7191    | 0.3163     | 2.27  |
| 115   | 1          | 16384       | 28672        | 8192           | 512                | 1.2099    | 0.5967     | 2.03  |
| 116   | 1          | 1024        | 53248        | 8192           | 512                | 0.5428    | 0.0897     | 6.05  |
| 117   | 1          | 2048        | 53248        | 8192           | 512                | 0.7031    | 0.1517     | 4.63  |
| 118   | 1          | 4096        | 53248        | 8192           | 512                | 0.8949    | 0.2791     | 3.21  |
| 119   | 1          | 8192        | 53248        | 8192           | 512                | 1.3050    | 0.5879     | 2.22  |
| 120   | 1          | 16384       | 53248        | 8192           | 512                | 2.2161    | 1.1342     | 1.95  |
