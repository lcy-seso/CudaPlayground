# Test on H100

| count | batch_size | in_features | out_features | main_centroids | residual_centroids | vptq (ms) | torch (ms) | ratio |
| ----- | ---------- | ----------- | ------------ | -------------- | ------------------ | --------- | ---------- | ----- |
| 1     | 1          | 1024        | 1024         | 4096           | 256                | 0.0110    | 0.0086     | 1.28  |
| 2     | 1          | 2048        | 1024         | 4096           | 256                | 0.0129    | 0.0101     | 1.28  |
| 3     | 1          | 4096        | 1024         | 4096           | 256                | 0.0165    | 0.0157     | 1.05  |
| 4     | 1          | 8192        | 1024         | 4096           | 256                | 0.0237    | 0.0203     | 1.17  |
| 5     | 1          | 16384       | 1024         | 4096           | 256                | 0.0377    | 0.0283     | 1.33  |
| 6     | 1          | 1024        | 4096         | 4096           | 256                | 0.0185    | 0.0140     | 1.32  |
| 7     | 1          | 2048        | 4096         | 4096           | 256                | 0.0233    | 0.0200     | 1.16  |
| 8     | 1          | 4096        | 4096         | 4096           | 256                | 0.0333    | 0.0265     | 1.26  |
| 9     | 1          | 8192        | 4096         | 4096           | 256                | 0.0535    | 0.0411     | 1.30  |
| 10    | 1          | 16384       | 4096         | 4096           | 256                | 0.0937    | 0.0637     | 1.47  |
| 11    | 1          | 1024        | 8192         | 4096           | 256                | 0.0254    | 0.0175     | 1.45  |
| 12    | 1          | 2048        | 8192         | 4096           | 256                | 0.0329    | 0.0256     | 1.29  |
| 13    | 1          | 4096        | 8192         | 4096           | 256                | 0.0483    | 0.0394     | 1.23  |
| 14    | 1          | 8192        | 8192         | 4096           | 256                | 0.0792    | 0.0631     | 1.25  |
| 15    | 1          | 16384       | 8192         | 4096           | 256                | 0.1398    | 0.1078     | 1.30  |
| 16    | 1          | 1024        | 14336        | 4096           | 256                | 0.0383    | 0.0233     | 1.64  |
| 17    | 1          | 2048        | 14336        | 4096           | 256                | 0.0508    | 0.0374     | 1.36  |
| 18    | 1          | 4096        | 14336        | 4096           | 256                | 0.0763    | 0.0589     | 1.30  |
| 19    | 1          | 8192        | 14336        | 4096           | 256                | 0.1271    | 0.0988     | 1.29  |
| 20    | 1          | 16384       | 14336        | 4096           | 256                | 0.2243    | 0.1765     | 1.27  |
| 21    | 1          | 1024        | 28672        | 4096           | 256                | 0.0688    | 0.0355     | 1.94  |
| 22    | 1          | 2048        | 28672        | 4096           | 256                | 0.0927    | 0.0601     | 1.54  |
| 23    | 1          | 4096        | 28672        | 4096           | 256                | 0.1419    | 0.1016     | 1.40  |
| 24    | 1          | 8192        | 28672        | 4096           | 256                | 0.2376    | 0.1754     | 1.35  |
| 25    | 1          | 16384       | 28672        | 4096           | 256                | 0.4285    | 0.3321     | 1.29  |
| 26    | 1          | 1024        | 53248        | 4096           | 256                | 0.1175    | 0.0582     | 2.02  |
| 27    | 1          | 2048        | 53248        | 4096           | 256                | 0.1602    | 0.0952     | 1.68  |
| 28    | 1          | 4096        | 53248        | 4096           | 256                | 0.2430    | 0.1983     | 1.23  |
| 29    | 1          | 8192        | 53248        | 4096           | 256                | 0.4084    | 0.3333     | 1.23  |
| 30    | 1          | 16384       | 53248        | 4096           | 256                | 0.7381    | 0.6189     | 1.19  |
| 31    | 1          | 1024        | 1024         | 8192           | 256                | 0.0112    | 0.0086     | 1.30  |
| 32    | 1          | 2048        | 1024         | 8192           | 256                | 0.0131    | 0.0100     | 1.30  |
| 33    | 1          | 4096        | 1024         | 8192           | 256                | 0.0167    | 0.0157     | 1.07  |
| 34    | 1          | 8192        | 1024         | 8192           | 256                | 0.0239    | 0.0203     | 1.18  |
| 35    | 1          | 16384       | 1024         | 8192           | 256                | 0.0379    | 0.0283     | 1.34  |
| 36    | 1          | 1024        | 4096         | 8192           | 256                | 0.0278    | 0.0140     | 1.98  |
| 37    | 1          | 2048        | 4096         | 8192           | 256                | 0.0348    | 0.0200     | 1.74  |
| 38    | 1          | 4096        | 4096         | 8192           | 256                | 0.0488    | 0.0264     | 1.84  |
| 39    | 1          | 8192        | 4096         | 8192           | 256                | 0.0768    | 0.0412     | 1.87  |
| 40    | 1          | 16384       | 4096         | 8192           | 256                | 0.1339    | 0.0636     | 2.11  |
| 41    | 1          | 1024        | 8192         | 8192           | 256                | 0.0499    | 0.0174     | 2.86  |
| 42    | 1          | 2048        | 8192         | 8192           | 256                | 0.0638    | 0.0256     | 2.49  |
| 43    | 1          | 4096        | 8192         | 8192           | 256                | 0.0917    | 0.0394     | 2.33  |
| 44    | 1          | 8192        | 8192         | 8192           | 256                | 0.1483    | 0.0631     | 2.35  |
| 45    | 1          | 16384       | 8192         | 8192           | 256                | 0.2601    | 0.1078     | 2.41  |
| 46    | 1          | 1024        | 14336        | 8192           | 256                | 0.0831    | 0.0234     | 3.56  |
| 47    | 1          | 2048        | 14336        | 8192           | 256                | 0.1074    | 0.0373     | 2.88  |
| 48    | 1          | 4096        | 14336        | 8192           | 256                | 0.1565    | 0.0589     | 2.66  |
| 49    | 1          | 8192        | 14336        | 8192           | 256                | 0.2553    | 0.0986     | 2.59  |
| 50    | 1          | 16384       | 14336        | 8192           | 256                | 0.4403    | 0.1762     | 2.50  |
| 51    | 1          | 1024        | 28672        | 8192           | 256                | 0.1608    | 0.0356     | 4.52  |
| 52    | 1          | 2048        | 28672        | 8192           | 256                | 0.2347    | 0.0600     | 3.91  |
| 53    | 1          | 4096        | 28672        | 8192           | 256                | 0.3076    | 0.1015     | 3.03  |
| 54    | 1          | 8192        | 28672        | 8192           | 256                | 0.4933    | 0.1753     | 2.81  |
| 55    | 1          | 16384       | 28672        | 8192           | 256                | 0.8567    | 0.3319     | 2.58  |
| 56    | 1          | 1024        | 53248        | 8192           | 256                | 0.2902    | 0.0581     | 4.99  |
| 57    | 1          | 2048        | 53248        | 8192           | 256                | 0.4068    | 0.0952     | 4.27  |
| 58    | 1          | 4096        | 53248        | 8192           | 256                | 0.5761    | 0.1979     | 2.91  |
| 59    | 1          | 8192        | 53248        | 8192           | 256                | 0.8871    | 0.3336     | 2.66  |
| 60    | 1          | 16384       | 53248        | 8192           | 256                | 1.5520    | 0.6189     | 2.51  |
| 61    | 1          | 1024        | 1024         | 4096           | 512                | 0.0108    | 0.0086     | 1.26  |
| 62    | 1          | 2048        | 1024         | 4096           | 512                | 0.0125    | 0.0101     | 1.24  |
| 63    | 1          | 4096        | 1024         | 4096           | 512                | 0.0155    | 0.0157     | 0.98  |
| 64    | 1          | 8192        | 1024         | 4096           | 512                | 0.0219    | 0.0201     | 1.09  |
| 65    | 1          | 16384       | 1024         | 4096           | 512                | 0.0293    | 0.0222     | 1.32  |
| 66    | 1          | 1024        | 4096         | 4096           | 512                | 0.0209    | 0.0171     | 1.22  |
| 67    | 1          | 2048        | 4096         | 4096           | 512                | 0.0229    | 0.0189     | 1.21  |
| 68    | 1          | 4096        | 4096         | 4096           | 512                | 0.0267    | 0.0216     | 1.24  |
| 69    | 1          | 8192        | 4096         | 4096           | 512                | 0.0353    | 0.0378     | 0.93  |
| 70    | 1          | 16384       | 4096         | 4096           | 512                | 0.0635    | 0.0596     | 1.07  |
| 71    | 1          | 1024        | 8192         | 4096           | 512                | 0.0307    | 0.0168     | 1.84  |
| 72    | 1          | 2048        | 8192         | 4096           | 512                | 0.0353    | 0.0208     | 1.70  |
| 73    | 1          | 4096        | 8192         | 4096           | 512                | 0.0430    | 0.0380     | 1.13  |
| 74    | 1          | 8192        | 8192         | 4096           | 512                | 0.0681    | 0.0594     | 1.15  |
| 75    | 1          | 16384       | 8192         | 4096           | 512                | 0.1262    | 0.1040     | 1.21  |
| 76    | 1          | 1024        | 14336        | 4096           | 512                | 0.0473    | 0.0201     | 2.35  |
| 77    | 1          | 2048        | 14336        | 4096           | 512                | 0.0540    | 0.0376     | 1.44  |
| 78    | 1          | 4096        | 14336        | 4096           | 512                | 0.0706    | 0.0546     | 1.29  |
| 79    | 1          | 8192        | 14336        | 4096           | 512                | 0.1240    | 0.0929     | 1.34  |
| 80    | 1          | 16384       | 14336        | 4096           | 512                | 0.2096    | 0.1667     | 1.26  |
| 81    | 1          | 1024        | 28672        | 4096           | 512                | 0.0838    | 0.0322     | 2.61  |
| 82    | 1          | 2048        | 28672        | 4096           | 512                | 0.0989    | 0.0582     | 1.70  |
| 83    | 1          | 4096        | 28672        | 4096           | 512                | 0.1508    | 0.0971     | 1.55  |
| 84    | 1          | 8192        | 28672        | 4096           | 512                | 0.2357    | 0.1687     | 1.40  |
| 85    | 1          | 16384       | 28672        | 4096           | 512                | 0.4101    | 0.3232     | 1.27  |
| 86    | 1          | 1024        | 53248        | 4096           | 512                | 0.1467    | 0.0553     | 2.66  |
| 87    | 1          | 2048        | 53248        | 4096           | 512                | 0.1916    | 0.0918     | 2.09  |
| 88    | 1          | 4096        | 53248        | 4096           | 512                | 0.2708    | 0.1643     | 1.65  |
| 89    | 1          | 8192        | 53248        | 4096           | 512                | 0.4293    | 0.2972     | 1.44  |
| 90    | 1          | 16384       | 53248        | 4096           | 512                | 0.7470    | 0.5761     | 1.30  |
| 91    | 1          | 1024        | 1024         | 8192           | 512                | 0.0151    | 0.0141     | 1.07  |
| 92    | 1          | 2048        | 1024         | 8192           | 512                | 0.0158    | 0.0144     | 1.10  |
| 93    | 1          | 4096        | 1024         | 8192           | 512                | 0.0179    | 0.0180     | 0.99  |
| 94    | 1          | 8192        | 1024         | 8192           | 512                | 0.0218    | 0.0197     | 1.10  |
| 95    | 1          | 16384       | 1024         | 8192           | 512                | 0.0294    | 0.0214     | 1.37  |
| 96    | 1          | 1024        | 4096         | 8192           | 512                | 0.0296    | 0.0163     | 1.81  |
| 97    | 1          | 2048        | 4096         | 8192           | 512                | 0.0331    | 0.0182     | 1.82  |
| 98    | 1          | 4096        | 4096         | 8192           | 512                | 0.0411    | 0.0218     | 1.88  |
| 99    | 1          | 8192        | 4096         | 8192           | 512                | 0.0556    | 0.0371     | 1.50  |
| 100   | 1          | 16384       | 4096         | 8192           | 512                | 0.1023    | 0.0594     | 1.72  |
| 101   | 1          | 1024        | 8192         | 8192           | 512                | 0.0497    | 0.0166     | 3.00  |
| 102   | 1          | 2048        | 8192         | 8192           | 512                | 0.0570    | 0.0213     | 2.67  |
| 103   | 1          | 4096        | 8192         | 8192           | 512                | 0.0715    | 0.0381     | 1.88  |
| 104   | 1          | 8192        | 8192         | 8192           | 512                | 0.1124    | 0.0595     | 1.89  |
| 105   | 1          | 16384       | 8192         | 8192           | 512                | 0.2225    | 0.1032     | 2.16  |
| 106   | 1          | 1024        | 14336        | 8192           | 512                | 0.0803    | 0.0202     | 3.97  |
| 107   | 1          | 2048        | 14336        | 8192           | 512                | 0.0929    | 0.0359     | 2.58  |
| 108   | 1          | 4096        | 14336        | 8192           | 512                | 0.1218    | 0.0549     | 2.22  |
| 109   | 1          | 8192        | 14336        | 8192           | 512                | 0.2219    | 0.0922     | 2.41  |
| 110   | 1          | 16384       | 14336        | 8192           | 512                | 0.3778    | 0.1663     | 2.27  |
| 111   | 1          | 1024        | 28672        | 8192           | 512                | 0.1506    | 0.0321     | 4.69  |
| 112   | 1          | 2048        | 28672        | 8192           | 512                | 0.1791    | 0.0568     | 3.15  |
| 113   | 1          | 4096        | 28672        | 8192           | 512                | 0.2771    | 0.0970     | 2.86  |
| 114   | 1          | 8192        | 28672        | 8192           | 512                | 0.4329    | 0.1687     | 2.57  |
| 115   | 1          | 16384       | 28672        | 8192           | 512                | 0.7455    | 0.3236     | 2.30  |
| 116   | 1          | 1024        | 53248        | 8192           | 512                | 0.2695    | 0.0541     | 4.98  |
| 117   | 1          | 2048        | 53248        | 8192           | 512                | 0.3543    | 0.0905     | 3.91  |
| 118   | 1          | 4096        | 53248        | 8192           | 512                | 0.4980    | 0.1623     | 3.07  |
| 119   | 1          | 8192        | 53248        | 8192           | 512                | 0.7865    | 0.2999     | 2.62  |
| 120   | 1          | 16384       | 53248        | 8192           | 512                | 1.3536    | 0.5754     | 2.35  |
