# Test on H100

| count | batch_size | in_features | out_features | main_centroids | residual_centroids | vptq (ms) | torch (ms) | ratio |
| ----- | ---------- | ----------- | ------------ | -------------- | ------------------ | --------- | ---------- | ----- |
| 1     | 1          | 1024        | 1024         | 4096           | 256                | 0.0135    | 0.0132     | 1.03  |
| 2     | 1          | 2048        | 1024         | 4096           | 256                | 0.0138    | 0.0136     | 1.02  |
| 3     | 1          | 4096        | 1024         | 4096           | 256                | 0.0155    | 0.0166     | 0.94  |
| 4     | 1          | 8192        | 1024         | 4096           | 256                | 0.0190    | 0.0190     | 1.00  |
| 5     | 1          | 16384       | 1024         | 4096           | 256                | 0.0260    | 0.0216     | 1.20  |
| 6     | 1          | 1024        | 4096         | 4096           | 256                | 0.0201    | 0.0158     | 1.27  |
| 7     | 1          | 2048        | 4096         | 4096           | 256                | 0.0224    | 0.0177     | 1.27  |
| 8     | 1          | 4096        | 4096         | 4096           | 256                | 0.0275    | 0.0209     | 1.32  |
| 9     | 1          | 8192        | 4096         | 4096           | 256                | 0.0387    | 0.0361     | 1.07  |
| 10    | 1          | 16384       | 4096         | 4096           | 256                | 0.0606    | 0.0591     | 1.03  |
| 11    | 1          | 1024        | 8192         | 4096           | 256                | 0.0306    | 0.0162     | 1.89  |
| 12    | 1          | 2048        | 8192         | 4096           | 256                | 0.0365    | 0.0204     | 1.79  |
| 13    | 1          | 4096        | 8192         | 4096           | 256                | 0.0470    | 0.0379     | 1.24  |
| 14    | 1          | 8192        | 8192         | 4096           | 256                | 0.0689    | 0.0588     | 1.17  |
| 15    | 1          | 16384       | 8192         | 4096           | 256                | 0.1271    | 0.1037     | 1.22  |
| 16    | 1          | 1024        | 14336        | 4096           | 256                | 0.0481    | 0.0197     | 2.44  |
| 17    | 1          | 2048        | 14336        | 4096           | 256                | 0.0578    | 0.0384     | 1.50  |
| 18    | 1          | 4096        | 14336        | 4096           | 256                | 0.0768    | 0.0566     | 1.36  |
| 19    | 1          | 8192        | 14336        | 4096           | 256                | 0.1263    | 0.0916     | 1.38  |
| 20    | 1          | 16384       | 14336        | 4096           | 256                | 0.2158    | 0.1652     | 1.31  |
| 21    | 1          | 1024        | 28672        | 4096           | 256                | 0.0864    | 0.0325     | 2.66  |
| 22    | 1          | 2048        | 28672        | 4096           | 256                | 0.1048    | 0.0569     | 1.84  |
| 23    | 1          | 4096        | 28672        | 4096           | 256                | 0.1531    | 0.0956     | 1.60  |
| 24    | 1          | 8192        | 28672        | 4096           | 256                | 0.2429    | 0.1727     | 1.41  |
| 25    | 1          | 16384       | 28672        | 4096           | 256                | 0.4198    | 0.3103     | 1.35  |
| 26    | 1          | 1024        | 53248        | 4096           | 256                | 0.1485    | 0.0538     | 2.76  |
| 27    | 1          | 2048        | 53248        | 4096           | 256                | 0.1934    | 0.0905     | 2.14  |
| 28    | 1          | 4096        | 53248        | 4096           | 256                | 0.2774    | 0.1661     | 1.67  |
| 29    | 1          | 8192        | 53248        | 4096           | 256                | 0.4423    | 0.3070     | 1.44  |
| 30    | 1          | 16384       | 53248        | 4096           | 256                | 0.7714    | 0.5959     | 1.29  |
| 31    | 1          | 1024        | 1024         | 8192           | 256                | 0.0147    | 0.0155     | 0.95  |
| 32    | 1          | 2048        | 1024         | 8192           | 256                | 0.0154    | 0.0156     | 0.99  |
| 33    | 1          | 4096        | 1024         | 8192           | 256                | 0.0173    | 0.0191     | 0.91  |
| 34    | 1          | 8192        | 1024         | 8192           | 256                | 0.0205    | 0.0202     | 1.01  |
| 35    | 1          | 16384       | 1024         | 8192           | 256                | 0.0273    | 0.0230     | 1.18  |
| 36    | 1          | 1024        | 4096         | 8192           | 256                | 0.0297    | 0.0179     | 1.66  |
| 37    | 1          | 2048        | 4096         | 8192           | 256                | 0.0329    | 0.0196     | 1.68  |
| 38    | 1          | 4096        | 4096         | 8192           | 256                | 0.0397    | 0.0215     | 1.85  |
| 39    | 1          | 8192        | 4096         | 8192           | 256                | 0.0528    | 0.0378     | 1.40  |
| 40    | 1          | 16384       | 4096         | 8192           | 256                | 0.0817    | 0.0617     | 1.32  |
| 41    | 1          | 1024        | 8192         | 8192           | 256                | 0.0489    | 0.0169     | 2.90  |
| 42    | 1          | 2048        | 8192         | 8192           | 256                | 0.0561    | 0.0207     | 2.71  |
| 43    | 1          | 4096        | 8192         | 8192           | 256                | 0.0690    | 0.0385     | 1.79  |
| 44    | 1          | 8192        | 8192         | 8192           | 256                | 0.0967    | 0.0596     | 1.62  |
| 45    | 1          | 16384       | 8192         | 8192           | 256                | 0.1809    | 0.1029     | 1.76  |
| 46    | 1          | 1024        | 14336        | 8192           | 256                | 0.0780    | 0.0190     | 4.11  |
| 47    | 1          | 2048        | 14336        | 8192           | 256                | 0.0898    | 0.0357     | 2.51  |
| 48    | 1          | 4096        | 14336        | 8192           | 256                | 0.1140    | 0.0535     | 2.13  |
| 49    | 1          | 8192        | 14336        | 8192           | 256                | 0.1858    | 0.0907     | 2.05  |
| 50    | 1          | 16384       | 14336        | 8192           | 256                | 0.3096    | 0.1649     | 1.88  |
| 51    | 1          | 1024        | 28672        | 8192           | 256                | 0.1451    | 0.0324     | 4.48  |
| 52    | 1          | 2048        | 28672        | 8192           | 256                | 0.1697    | 0.0565     | 3.01  |
| 53    | 1          | 4096        | 28672        | 8192           | 256                | 0.2405    | 0.0957     | 2.51  |
| 54    | 1          | 8192        | 28672        | 8192           | 256                | 0.3643    | 0.1716     | 2.12  |
| 55    | 1          | 16384       | 28672        | 8192           | 256                | 0.6090    | 0.3103     | 1.96  |
| 56    | 1          | 1024        | 53248        | 8192           | 256                | 0.2570    | 0.0537     | 4.78  |
| 57    | 1          | 2048        | 53248        | 8192           | 256                | 0.3214    | 0.0902     | 3.56  |
| 58    | 1          | 4096        | 53248        | 8192           | 256                | 0.4351    | 0.1660     | 2.62  |
| 59    | 1          | 8192        | 53248        | 8192           | 256                | 0.6601    | 0.3061     | 2.16  |
| 60    | 1          | 16384       | 53248        | 8192           | 256                | 1.1037    | 0.5935     | 1.86  |
| 61    | 1          | 1024        | 1024         | 4096           | 512                | 0.0134    | 0.0134     | 1.00  |
| 62    | 1          | 2048        | 1024         | 4096           | 512                | 0.0143    | 0.0140     | 1.02  |
| 63    | 1          | 4096        | 1024         | 4096           | 512                | 0.0157    | 0.0167     | 0.94  |
| 64    | 1          | 8192        | 1024         | 4096           | 512                | 0.0189    | 0.0187     | 1.01  |
| 65    | 1          | 16384       | 1024         | 4096           | 512                | 0.0258    | 0.0210     | 1.23  |
| 66    | 1          | 1024        | 4096         | 4096           | 512                | 0.0197    | 0.0159     | 1.23  |
| 67    | 1          | 2048        | 4096         | 4096           | 512                | 0.0225    | 0.0179     | 1.25  |
| 68    | 1          | 4096        | 4096         | 4096           | 512                | 0.0281    | 0.0206     | 1.36  |
| 69    | 1          | 8192        | 4096         | 4096           | 512                | 0.0392    | 0.0362     | 1.08  |
| 70    | 1          | 16384       | 4096         | 4096           | 512                | 0.0651    | 0.0588     | 1.11  |
| 71    | 1          | 1024        | 8192         | 4096           | 512                | 0.0310    | 0.0163     | 1.90  |
| 72    | 1          | 2048        | 8192         | 4096           | 512                | 0.0368    | 0.0210     | 1.76  |
| 73    | 1          | 4096        | 8192         | 4096           | 512                | 0.0476    | 0.0385     | 1.23  |
| 74    | 1          | 8192        | 8192         | 4096           | 512                | 0.0717    | 0.0586     | 1.22  |
| 75    | 1          | 16384       | 8192         | 4096           | 512                | 0.1267    | 0.1027     | 1.23  |
| 76    | 1          | 1024        | 14336        | 4096           | 512                | 0.0477    | 0.0191     | 2.50  |
| 77    | 1          | 2048        | 14336        | 4096           | 512                | 0.0568    | 0.0356     | 1.59  |
| 78    | 1          | 4096        | 14336        | 4096           | 512                | 0.0763    | 0.0536     | 1.42  |
| 79    | 1          | 8192        | 14336        | 4096           | 512                | 0.1253    | 0.0908     | 1.38  |
| 80    | 1          | 16384       | 14336        | 4096           | 512                | 0.2133    | 0.1641     | 1.30  |
| 81    | 1          | 1024        | 28672        | 4096           | 512                | 0.0862    | 0.0320     | 2.70  |
| 82    | 1          | 2048        | 28672        | 4096           | 512                | 0.1055    | 0.0570     | 1.85  |
| 83    | 1          | 4096        | 28672        | 4096           | 512                | 0.1537    | 0.0953     | 1.61  |
| 84    | 1          | 8192        | 28672        | 4096           | 512                | 0.2389    | 0.1717     | 1.39  |
| 85    | 1          | 16384       | 28672        | 4096           | 512                | 0.4163    | 0.3112     | 1.34  |
| 86    | 1          | 1024        | 53248        | 4096           | 512                | 0.1495    | 0.0538     | 2.78  |
| 87    | 1          | 2048        | 53248        | 4096           | 512                | 0.1974    | 0.0904     | 2.18  |
| 88    | 1          | 4096        | 53248        | 4096           | 512                | 0.2741    | 0.1670     | 1.64  |
| 89    | 1          | 8192        | 53248        | 4096           | 512                | 0.4372    | 0.3079     | 1.42  |
| 90    | 1          | 16384       | 53248        | 4096           | 512                | 0.7584    | 0.5951     | 1.27  |
| 91    | 1          | 1024        | 1024         | 8192           | 512                | 0.0133    | 0.0131     | 1.01  |
| 92    | 1          | 2048        | 1024         | 8192           | 512                | 0.0143    | 0.0144     | 1.00  |
| 93    | 1          | 4096        | 1024         | 8192           | 512                | 0.0165    | 0.0180     | 0.91  |
| 94    | 1          | 8192        | 1024         | 8192           | 512                | 0.0200    | 0.0196     | 1.02  |
| 95    | 1          | 16384       | 1024         | 8192           | 512                | 0.0264    | 0.0224     | 1.18  |
| 96    | 1          | 1024        | 4096         | 8192           | 512                | 0.0294    | 0.0171     | 1.72  |
| 97    | 1          | 2048        | 4096         | 8192           | 512                | 0.0318    | 0.0179     | 1.78  |
| 98    | 1          | 4096        | 4096         | 8192           | 512                | 0.0385    | 0.0210     | 1.83  |
| 99    | 1          | 8192        | 4096         | 8192           | 512                | 0.0524    | 0.0368     | 1.42  |
| 100   | 1          | 16384       | 4096         | 8192           | 512                | 0.0889    | 0.0596     | 1.49  |
| 101   | 1          | 1024        | 8192         | 8192           | 512                | 0.0488    | 0.0161     | 3.04  |
| 102   | 1          | 2048        | 8192         | 8192           | 512                | 0.0554    | 0.0207     | 2.67  |
| 103   | 1          | 4096        | 8192         | 8192           | 512                | 0.0690    | 0.0379     | 1.82  |
| 104   | 1          | 8192        | 8192         | 8192           | 512                | 0.1033    | 0.0585     | 1.77  |
| 105   | 1          | 16384       | 8192         | 8192           | 512                | 0.1818    | 0.1031     | 1.76  |
| 106   | 1          | 1024        | 14336        | 8192           | 512                | 0.0777    | 0.0190     | 4.09  |
| 107   | 1          | 2048        | 14336        | 8192           | 512                | 0.0897    | 0.0355     | 2.52  |
| 108   | 1          | 4096        | 14336        | 8192           | 512                | 0.1161    | 0.0539     | 2.16  |
| 109   | 1          | 8192        | 14336        | 8192           | 512                | 0.1875    | 0.0909     | 2.06  |
| 110   | 1          | 16384       | 14336        | 8192           | 512                | 0.3076    | 0.1641     | 1.88  |
| 111   | 1          | 1024        | 28672        | 8192           | 512                | 0.1464    | 0.0332     | 4.41  |
| 112   | 1          | 2048        | 28672        | 8192           | 512                | 0.1759    | 0.0578     | 3.04  |
| 113   | 1          | 4096        | 28672        | 8192           | 512                | 0.2432    | 0.0980     | 2.48  |
| 114   | 1          | 8192        | 28672        | 8192           | 512                | 0.3633    | 0.1741     | 2.09  |
| 115   | 1          | 16384       | 28672        | 8192           | 512                | 0.6154    | 0.3127     | 1.97  |
| 116   | 1          | 1024        | 53248        | 8192           | 512                | 0.2587    | 0.0536     | 4.83  |
| 117   | 1          | 2048        | 53248        | 8192           | 512                | 0.3249    | 0.0904     | 3.60  |
| 118   | 1          | 4096        | 53248        | 8192           | 512                | 0.4350    | 0.1652     | 2.63  |
| 119   | 1          | 8192        | 53248        | 8192           | 512                | 0.6662    | 0.3056     | 2.18  |
| 120   | 1          | 16384       | 53248        | 8192           | 512                | 1.0953    | 0.5954     | 1.84  |
