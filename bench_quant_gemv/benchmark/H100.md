# Test on H100

| count | batch_size | in_features | out_features | main_centroids | residual_centroids | vptq (ms) | torch (ms) | ratio |
| ----- | ---------- | ----------- | ------------ | -------------- | ------------------ | --------- | ---------- | ----- |
| 1     | 1          | 1024        | 1024         | 4096           | 256                | 0.0151    | 0.0152     | 0.99  |
| 2     | 1          | 2048        | 1024         | 4096           | 256                | 0.0168    | 0.0147     | 1.14  |
| 3     | 1          | 4096        | 1024         | 4096           | 256                | 0.0179    | 0.0181     | 0.99  |
| 4     | 1          | 8192        | 1024         | 4096           | 256                | 0.0229    | 0.0202     | 1.14  |
| 5     | 1          | 16384       | 1024         | 4096           | 256                | 0.0325    | 0.0223     | 1.46  |
| 6     | 1          | 1024        | 4096         | 4096           | 256                | 0.0227    | 0.0166     | 1.36  |
| 7     | 1          | 2048        | 4096         | 4096           | 256                | 0.0264    | 0.0188     | 1.41  |
| 8     | 1          | 4096        | 4096         | 4096           | 256                | 0.0347    | 0.0219     | 1.59  |
| 9     | 1          | 8192        | 4096         | 4096           | 256                | 0.0510    | 0.0378     | 1.35  |
| 10    | 1          | 16384       | 4096         | 4096           | 256                | 0.0839    | 0.0604     | 1.39  |
| 11    | 1          | 1024        | 8192         | 4096           | 256                | 0.0294    | 0.0175     | 1.68  |
| 12    | 1          | 2048        | 8192         | 4096           | 256                | 0.0354    | 0.0219     | 1.62  |
| 13    | 1          | 4096        | 8192         | 4096           | 256                | 0.0476    | 0.0393     | 1.21  |
| 14    | 1          | 8192        | 8192         | 4096           | 256                | 0.0715    | 0.0597     | 1.20  |
| 15    | 1          | 16384       | 8192         | 4096           | 256                | 0.1392    | 0.1038     | 1.34  |
| 16    | 1          | 1024        | 14336        | 4096           | 256                | 0.0413    | 0.0196     | 2.11  |
| 17    | 1          | 2048        | 14336        | 4096           | 256                | 0.0510    | 0.0371     | 1.37  |
| 18    | 1          | 4096        | 14336        | 4096           | 256                | 0.0709    | 0.0556     | 1.28  |
| 19    | 1          | 8192        | 14336        | 4096           | 256                | 0.1267    | 0.0932     | 1.36  |
| 20    | 1          | 16384       | 14336        | 4096           | 256                | 0.2235    | 0.1679     | 1.33  |
| 21    | 1          | 1024        | 28672        | 4096           | 256                | 0.0701    | 0.0332     | 2.11  |
| 22    | 1          | 2048        | 28672        | 4096           | 256                | 0.0905    | 0.0578     | 1.57  |
| 23    | 1          | 4096        | 28672        | 4096           | 256                | 0.1427    | 0.0971     | 1.47  |
| 24    | 1          | 8192        | 28672        | 4096           | 256                | 0.2384    | 0.1711     | 1.39  |
| 25    | 1          | 16384       | 28672        | 4096           | 256                | 0.4284    | 0.3247     | 1.32  |
| 26    | 1          | 1024        | 53248        | 4096           | 256                | 0.1153    | 0.0551     | 2.09  |
| 27    | 1          | 2048        | 53248        | 4096           | 256                | 0.1581    | 0.0909     | 1.74  |
| 28    | 1          | 4096        | 53248        | 4096           | 256                | 0.2432    | 0.1637     | 1.49  |
| 29    | 1          | 8192        | 53248        | 4096           | 256                | 0.4088    | 0.3062     | 1.34  |
| 30    | 1          | 16384       | 53248        | 4096           | 256                | 0.7382    | 0.5925     | 1.25  |
| 31    | 1          | 1024        | 1024         | 8192           | 256                | 0.0156    | 0.0149     | 1.04  |
| 32    | 1          | 2048        | 1024         | 8192           | 256                | 0.0167    | 0.0147     | 1.14  |
| 33    | 1          | 4096        | 1024         | 8192           | 256                | 0.0187    | 0.0178     | 1.05  |
| 34    | 1          | 8192        | 1024         | 8192           | 256                | 0.0233    | 0.0205     | 1.13  |
| 35    | 1          | 16384       | 1024         | 8192           | 256                | 0.0332    | 0.0221     | 1.50  |
| 36    | 1          | 1024        | 4096         | 8192           | 256                | 0.0310    | 0.0172     | 1.81  |
| 37    | 1          | 2048        | 4096         | 8192           | 256                | 0.0355    | 0.0186     | 1.91  |
| 38    | 1          | 4096        | 4096         | 8192           | 256                | 0.0445    | 0.0220     | 2.02  |
| 39    | 1          | 8192        | 4096         | 8192           | 256                | 0.0630    | 0.0380     | 1.66  |
| 40    | 1          | 16384       | 4096         | 8192           | 256                | 0.1032    | 0.0609     | 1.70  |
| 41    | 1          | 1024        | 8192         | 8192           | 256                | 0.0524    | 0.0178     | 2.95  |
| 42    | 1          | 2048        | 8192         | 8192           | 256                | 0.0610    | 0.0216     | 2.82  |
| 43    | 1          | 4096        | 8192         | 8192           | 256                | 0.0796    | 0.0407     | 1.96  |
| 44    | 1          | 8192        | 8192         | 8192           | 256                | 0.1172    | 0.0606     | 1.93  |
| 45    | 1          | 16384       | 8192         | 8192           | 256                | 0.2536    | 0.1054     | 2.41  |
| 46    | 1          | 1024        | 14336        | 8192           | 256                | 0.0837    | 0.0208     | 4.02  |
| 47    | 1          | 2048        | 14336        | 8192           | 256                | 0.0997    | 0.0391     | 2.55  |
| 48    | 1          | 4096        | 14336        | 8192           | 256                | 0.1317    | 0.0572     | 2.30  |
| 49    | 1          | 8192        | 14336        | 8192           | 256                | 0.2500    | 0.0949     | 2.64  |
| 50    | 1          | 16384       | 14336        | 8192           | 256                | 0.4341    | 0.1692     | 2.57  |
| 51    | 1          | 1024        | 28672        | 8192           | 256                | 0.1548    | 0.0338     | 4.58  |
| 52    | 1          | 2048        | 28672        | 8192           | 256                | 0.1866    | 0.0590     | 3.16  |
| 53    | 1          | 4096        | 28672        | 8192           | 256                | 0.3022    | 0.0979     | 3.09  |
| 54    | 1          | 8192        | 28672        | 8192           | 256                | 0.4884    | 0.1725     | 2.83  |
| 55    | 1          | 16384       | 28672        | 8192           | 256                | 0.8506    | 0.3263     | 2.61  |
| 56    | 1          | 1024        | 53248        | 8192           | 256                | 0.2730    | 0.0565     | 4.83  |
| 57    | 1          | 2048        | 53248        | 8192           | 256                | 0.3703    | 0.0930     | 3.98  |
| 58    | 1          | 4096        | 53248        | 8192           | 256                | 0.5448    | 0.1653     | 3.30  |
| 59    | 1          | 8192        | 53248        | 8192           | 256                | 0.8822    | 0.3062     | 2.88  |
| 60    | 1          | 16384       | 53248        | 8192           | 256                | 1.5449    | 0.5917     | 2.61  |
| 61    | 1          | 1024        | 1024         | 4096           | 512                | 0.0155    | 0.0145     | 1.07  |
| 62    | 1          | 2048        | 1024         | 4096           | 512                | 0.0180    | 0.0146     | 1.23  |
| 63    | 1          | 4096        | 1024         | 4096           | 512                | 0.0179    | 0.0191     | 0.94  |
| 64    | 1          | 8192        | 1024         | 4096           | 512                | 0.0217    | 0.0201     | 1.08  |
| 65    | 1          | 16384       | 1024         | 4096           | 512                | 0.0291    | 0.0222     | 1.31  |
| 66    | 1          | 1024        | 4096         | 4096           | 512                | 0.0209    | 0.0172     | 1.21  |
| 67    | 1          | 2048        | 4096         | 4096           | 512                | 0.0229    | 0.0187     | 1.22  |
| 68    | 1          | 4096        | 4096         | 4096           | 512                | 0.0273    | 0.0219     | 1.24  |
| 69    | 1          | 8192        | 4096         | 4096           | 512                | 0.0357    | 0.0389     | 0.92  |
| 70    | 1          | 16384       | 4096         | 4096           | 512                | 0.0649    | 0.0604     | 1.07  |
| 71    | 1          | 1024        | 8192         | 4096           | 512                | 0.0312    | 0.0174     | 1.79  |
| 72    | 1          | 2048        | 8192         | 4096           | 512                | 0.0354    | 0.0219     | 1.62  |
| 73    | 1          | 4096        | 8192         | 4096           | 512                | 0.0434    | 0.0402     | 1.08  |
| 74    | 1          | 8192        | 8192         | 4096           | 512                | 0.0700    | 0.0609     | 1.15  |
| 75    | 1          | 16384       | 8192         | 4096           | 512                | 0.1274    | 0.1057     | 1.21  |
| 76    | 1          | 1024        | 14336        | 4096           | 512                | 0.0475    | 0.0209     | 2.27  |
| 77    | 1          | 2048        | 14336        | 4096           | 512                | 0.0547    | 0.0386     | 1.42  |
| 78    | 1          | 4096        | 14336        | 4096           | 512                | 0.0713    | 0.0572     | 1.25  |
| 79    | 1          | 8192        | 14336        | 4096           | 512                | 0.1261    | 0.0941     | 1.34  |
| 80    | 1          | 16384       | 14336        | 4096           | 512                | 0.2090    | 0.1686     | 1.24  |
| 81    | 1          | 1024        | 28672        | 4096           | 512                | 0.0842    | 0.0332     | 2.54  |
| 82    | 1          | 2048        | 28672        | 4096           | 512                | 0.0994    | 0.0590     | 1.68  |
| 83    | 1          | 4096        | 28672        | 4096           | 512                | 0.1528    | 0.0960     | 1.59  |
| 84    | 1          | 8192        | 28672        | 4096           | 512                | 0.2354    | 0.1717     | 1.37  |
| 85    | 1          | 16384       | 28672        | 4096           | 512                | 0.4157    | 0.3242     | 1.28  |
| 86    | 1          | 1024        | 53248        | 4096           | 512                | 0.1463    | 0.0562     | 2.60  |
| 87    | 1          | 2048        | 53248        | 4096           | 512                | 0.1934    | 0.0930     | 2.08  |
| 88    | 1          | 4096        | 53248        | 4096           | 512                | 0.2693    | 0.1624     | 1.66  |
| 89    | 1          | 8192        | 53248        | 4096           | 512                | 0.4362    | 0.3062     | 1.42  |
| 90    | 1          | 16384       | 53248        | 4096           | 512                | 0.7381    | 0.5931     | 1.24  |
| 91    | 1          | 1024        | 1024         | 8192           | 512                | 0.0155    | 0.0147     | 1.06  |
| 92    | 1          | 2048        | 1024         | 8192           | 512                | 0.0169    | 0.0156     | 1.09  |
| 93    | 1          | 4096        | 1024         | 8192           | 512                | 0.0189    | 0.0190     | 1.00  |
| 94    | 1          | 8192        | 1024         | 8192           | 512                | 0.0224    | 0.0209     | 1.07  |
| 95    | 1          | 16384       | 1024         | 8192           | 512                | 0.0304    | 0.0224     | 1.35  |
| 96    | 1          | 1024        | 4096         | 8192           | 512                | 0.0306    | 0.0173     | 1.77  |
| 97    | 1          | 2048        | 4096         | 8192           | 512                | 0.0342    | 0.0188     | 1.82  |
| 98    | 1          | 4096        | 4096         | 8192           | 512                | 0.0415    | 0.0227     | 1.82  |
| 99    | 1          | 8192        | 4096         | 8192           | 512                | 0.0563    | 0.0380     | 1.48  |
| 100   | 1          | 16384       | 4096         | 8192           | 512                | 0.1063    | 0.0612     | 1.74  |
| 101   | 1          | 1024        | 8192         | 8192           | 512                | 0.0506    | 0.0175     | 2.89  |
| 102   | 1          | 2048        | 8192         | 8192           | 512                | 0.0579    | 0.0224     | 2.59  |
| 103   | 1          | 4096        | 8192         | 8192           | 512                | 0.0723    | 0.0403     | 1.80  |
| 104   | 1          | 8192        | 8192         | 8192           | 512                | 0.1161    | 0.0605     | 1.92  |
| 105   | 1          | 16384       | 8192         | 8192           | 512                | 0.2253    | 0.1043     | 2.16  |
| 106   | 1          | 1024        | 14336        | 8192           | 512                | 0.0808    | 0.0204     | 3.95  |
| 107   | 1          | 2048        | 14336        | 8192           | 512                | 0.0935    | 0.0387     | 2.42  |
| 108   | 1          | 4096        | 14336        | 8192           | 512                | 0.1227    | 0.0573     | 2.14  |
| 109   | 1          | 8192        | 14336        | 8192           | 512                | 0.2260    | 0.0945     | 2.39  |
| 110   | 1          | 16384       | 14336        | 8192           | 512                | 0.3758    | 0.1692     | 2.22  |
| 111   | 1          | 1024        | 28672        | 8192           | 512                | 0.1512    | 0.0340     | 4.45  |
| 112   | 1          | 2048        | 28672        | 8192           | 512                | 0.1804    | 0.0599     | 3.01  |
| 113   | 1          | 4096        | 28672        | 8192           | 512                | 0.2798    | 0.0968     | 2.89  |
| 114   | 1          | 8192        | 28672        | 8192           | 512                | 0.4293    | 0.1723     | 2.49  |
| 115   | 1          | 16384       | 28672        | 8192           | 512                | 0.7632    | 0.3245     | 2.35  |
| 116   | 1          | 1024        | 53248        | 8192           | 512                | 0.2691    | 0.0569     | 4.73  |
| 117   | 1          | 2048        | 53248        | 8192           | 512                | 0.3565    | 0.0927     | 3.85  |
| 118   | 1          | 4096        | 53248        | 8192           | 512                | 0.4940    | 0.1629     | 3.03  |
| 119   | 1          | 8192        | 53248        | 8192           | 512                | 0.8032    | 0.3058     | 2.63  |
| 120   | 1          | 16384       | 53248        | 8192           | 512                | 1.3314    | 0.5923     | 2.25  |
