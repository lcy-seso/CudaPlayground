# Test on H100

| count | batch_size | in_features | out_features | main_centroids | residual_centroids | vptq (ms) | torch (ms) | ratio |
| ----- | ---------- | ----------- | ------------ | -------------- | ------------------ | --------- | ---------- | ----- |
| 1     | 1          | 1024        | 1024         | 4096           | 256                | 0.0149    | 0.0155     | 0.96  |
| 2     | 1          | 2048        | 1024         | 4096           | 256                | 0.0150    | 0.0140     | 1.07  |
| 3     | 1          | 4096        | 1024         | 4096           | 256                | 0.0170    | 0.0181     | 0.94  |
| 4     | 1          | 8192        | 1024         | 4096           | 256                | 0.0222    | 0.0200     | 1.11  |
| 5     | 1          | 16384       | 1024         | 4096           | 256                | 0.0313    | 0.0225     | 1.39  |
| 6     | 1          | 1024        | 4096         | 4096           | 256                | 0.0215    | 0.0168     | 1.28  |
| 7     | 1          | 2048        | 4096         | 4096           | 256                | 0.0249    | 0.0180     | 1.38  |
| 8     | 1          | 4096        | 4096         | 4096           | 256                | 0.0330    | 0.0217     | 1.52  |
| 9     | 1          | 8192        | 4096         | 4096           | 256                | 0.0495    | 0.0361     | 1.37  |
| 10    | 1          | 16384       | 4096         | 4096           | 256                | 0.0822    | 0.0591     | 1.39  |
| 11    | 1          | 1024        | 8192         | 4096           | 256                | 0.0280    | 0.0168     | 1.67  |
| 12    | 1          | 2048        | 8192         | 4096           | 256                | 0.0339    | 0.0211     | 1.60  |
| 13    | 1          | 4096        | 8192         | 4096           | 256                | 0.0463    | 0.0391     | 1.19  |
| 14    | 1          | 8192        | 8192         | 4096           | 256                | 0.0705    | 0.0594     | 1.19  |
| 15    | 1          | 16384       | 8192         | 4096           | 256                | 0.1381    | 0.1032     | 1.34  |
| 16    | 1          | 1024        | 14336        | 4096           | 256                | 0.0399    | 0.0196     | 2.04  |
| 17    | 1          | 2048        | 14336        | 4096           | 256                | 0.0503    | 0.0369     | 1.36  |
| 18    | 1          | 4096        | 14336        | 4096           | 256                | 0.0701    | 0.0548     | 1.28  |
| 19    | 1          | 8192        | 14336        | 4096           | 256                | 0.1257    | 0.0906     | 1.39  |
| 20    | 1          | 16384       | 14336        | 4096           | 256                | 0.2227    | 0.1654     | 1.35  |
| 21    | 1          | 1024        | 28672        | 4096           | 256                | 0.0691    | 0.0326     | 2.12  |
| 22    | 1          | 2048        | 28672        | 4096           | 256                | 0.0888    | 0.0574     | 1.55  |
| 23    | 1          | 4096        | 28672        | 4096           | 256                | 0.1419    | 0.0967     | 1.47  |
| 24    | 1          | 8192        | 28672        | 4096           | 256                | 0.2366    | 0.1687     | 1.40  |
| 25    | 1          | 16384       | 28672        | 4096           | 256                | 0.4272    | 0.3108     | 1.37  |
| 26    | 1          | 1024        | 53248        | 4096           | 256                | 0.1146    | 0.0551     | 2.08  |
| 27    | 1          | 2048        | 53248        | 4096           | 256                | 0.1573    | 0.0909     | 1.73  |
| 28    | 1          | 4096        | 53248        | 4096           | 256                | 0.2427    | 0.1665     | 1.46  |
| 29    | 1          | 8192        | 53248        | 4096           | 256                | 0.4082    | 0.2928     | 1.39  |
| 30    | 1          | 16384       | 53248        | 4096           | 256                | 0.7380    | 0.5755     | 1.28  |
| 31    | 1          | 1024        | 1024         | 8192           | 256                | 0.0147    | 0.0153     | 0.96  |
| 32    | 1          | 2048        | 1024         | 8192           | 256                | 0.0160    | 0.0154     | 1.03  |
| 33    | 1          | 4096        | 1024         | 8192           | 256                | 0.0183    | 0.0185     | 0.99  |
| 34    | 1          | 8192        | 1024         | 8192           | 256                | 0.0225    | 0.0203     | 1.11  |
| 35    | 1          | 16384       | 1024         | 8192           | 256                | 0.0325    | 0.0233     | 1.39  |
| 36    | 1          | 1024        | 4096         | 8192           | 256                | 0.0301    | 0.0171     | 1.75  |
| 37    | 1          | 2048        | 4096         | 8192           | 256                | 0.0345    | 0.0195     | 1.77  |
| 38    | 1          | 4096        | 4096         | 8192           | 256                | 0.0439    | 0.0228     | 1.93  |
| 39    | 1          | 8192        | 4096         | 8192           | 256                | 0.0621    | 0.0374     | 1.66  |
| 40    | 1          | 16384       | 4096         | 8192           | 256                | 0.1023    | 0.0611     | 1.68  |
| 41    | 1          | 1024        | 8192         | 8192           | 256                | 0.0513    | 0.0178     | 2.88  |
| 42    | 1          | 2048        | 8192         | 8192           | 256                | 0.0601    | 0.0218     | 2.76  |
| 43    | 1          | 4096        | 8192         | 8192           | 256                | 0.0782    | 0.0398     | 1.97  |
| 44    | 1          | 8192        | 8192         | 8192           | 256                | 0.1167    | 0.0606     | 1.93  |
| 45    | 1          | 16384       | 8192         | 8192           | 256                | 0.2529    | 0.1053     | 2.40  |
| 46    | 1          | 1024        | 14336        | 8192           | 256                | 0.0822    | 0.0205     | 4.02  |
| 47    | 1          | 2048        | 14336        | 8192           | 256                | 0.0975    | 0.0376     | 2.59  |
| 48    | 1          | 4096        | 14336        | 8192           | 256                | 0.1305    | 0.0557     | 2.34  |
| 49    | 1          | 8192        | 14336        | 8192           | 256                | 0.2501    | 0.0924     | 2.71  |
| 50    | 1          | 16384       | 14336        | 8192           | 256                | 0.4331    | 0.1669     | 2.59  |
| 51    | 1          | 1024        | 28672        | 8192           | 256                | 0.1534    | 0.0330     | 4.65  |
| 52    | 1          | 2048        | 28672        | 8192           | 256                | 0.1860    | 0.0583     | 3.19  |
| 53    | 1          | 4096        | 28672        | 8192           | 256                | 0.3016    | 0.0981     | 3.07  |
| 54    | 1          | 8192        | 28672        | 8192           | 256                | 0.4882    | 0.1683     | 2.90  |
| 55    | 1          | 16384       | 28672        | 8192           | 256                | 0.8482    | 0.3118     | 2.72  |
| 56    | 1          | 1024        | 53248        | 8192           | 256                | 0.2715    | 0.0544     | 4.99  |
| 57    | 1          | 2048        | 53248        | 8192           | 256                | 0.3673    | 0.0915     | 4.02  |
| 58    | 1          | 4096        | 53248        | 8192           | 256                | 0.5441    | 0.1671     | 3.26  |
| 59    | 1          | 8192        | 53248        | 8192           | 256                | 0.8858    | 0.2949     | 3.00  |
| 60    | 1          | 16384       | 53248        | 8192           | 256                | 1.5441    | 0.5738     | 2.69  |
| 61    | 1          | 1024        | 1024         | 4096           | 512                | 0.0143    | 0.0151     | 0.95  |
| 62    | 1          | 2048        | 1024         | 4096           | 512                | 0.0152    | 0.0153     | 0.99  |
| 63    | 1          | 4096        | 1024         | 4096           | 512                | 0.0172    | 0.0191     | 0.90  |
| 64    | 1          | 8192        | 1024         | 4096           | 512                | 0.0209    | 0.0203     | 1.03  |
| 65    | 1          | 16384       | 1024         | 4096           | 512                | 0.0288    | 0.0225     | 1.28  |
| 66    | 1          | 1024        | 4096         | 4096           | 512                | 0.0202    | 0.0177     | 1.14  |
| 67    | 1          | 2048        | 4096         | 4096           | 512                | 0.0223    | 0.0196     | 1.14  |
| 68    | 1          | 4096        | 4096         | 4096           | 512                | 0.0262    | 0.0221     | 1.18  |
| 69    | 1          | 8192        | 4096         | 4096           | 512                | 0.0344    | 0.0375     | 0.92  |
| 70    | 1          | 16384       | 4096         | 4096           | 512                | 0.0639    | 0.0606     | 1.05  |
| 71    | 1          | 1024        | 8192         | 4096           | 512                | 0.0306    | 0.0176     | 1.74  |
| 72    | 1          | 2048        | 8192         | 4096           | 512                | 0.0349    | 0.0218     | 1.60  |
| 73    | 1          | 4096        | 8192         | 4096           | 512                | 0.0428    | 0.0402     | 1.06  |
| 74    | 1          | 8192        | 8192         | 4096           | 512                | 0.0685    | 0.0607     | 1.13  |
| 75    | 1          | 16384       | 8192         | 4096           | 512                | 0.1264    | 0.1043     | 1.21  |
| 76    | 1          | 1024        | 14336        | 4096           | 512                | 0.0459    | 0.0194     | 2.37  |
| 77    | 1          | 2048        | 14336        | 4096           | 512                | 0.0526    | 0.0363     | 1.45  |
| 78    | 1          | 4096        | 14336        | 4096           | 512                | 0.0693    | 0.0547     | 1.27  |
| 79    | 1          | 8192        | 14336        | 4096           | 512                | 0.1246    | 0.0916     | 1.36  |
| 80    | 1          | 16384       | 14336        | 4096           | 512                | 0.2080    | 0.1648     | 1.26  |
| 81    | 1          | 1024        | 28672        | 4096           | 512                | 0.0829    | 0.0322     | 2.58  |
| 82    | 1          | 2048        | 28672        | 4096           | 512                | 0.0975    | 0.0566     | 1.72  |
| 83    | 1          | 4096        | 28672        | 4096           | 512                | 0.1512    | 0.0965     | 1.57  |
| 84    | 1          | 8192        | 28672        | 4096           | 512                | 0.2342    | 0.1693     | 1.38  |
| 85    | 1          | 16384       | 28672        | 4096           | 512                | 0.4158    | 0.3117     | 1.33  |
| 86    | 1          | 1024        | 53248        | 4096           | 512                | 0.1455    | 0.0543     | 2.68  |
| 87    | 1          | 2048        | 53248        | 4096           | 512                | 0.1930    | 0.0911     | 2.12  |
| 88    | 1          | 4096        | 53248        | 4096           | 512                | 0.2691    | 0.1662     | 1.62  |
| 89    | 1          | 8192        | 53248        | 4096           | 512                | 0.4365    | 0.2957     | 1.48  |
| 90    | 1          | 16384       | 53248        | 4096           | 512                | 0.7380    | 0.5724     | 1.29  |
| 91    | 1          | 1024        | 1024         | 8192           | 512                | 0.0133    | 0.0125     | 1.06  |
| 92    | 1          | 2048        | 1024         | 8192           | 512                | 0.0144    | 0.0137     | 1.05  |
| 93    | 1          | 4096        | 1024         | 8192           | 512                | 0.0166    | 0.0172     | 0.97  |
| 94    | 1          | 8192        | 1024         | 8192           | 512                | 0.0204    | 0.0196     | 1.04  |
| 95    | 1          | 16384       | 1024         | 8192           | 512                | 0.0287    | 0.0219     | 1.31  |
| 96    | 1          | 1024        | 4096         | 8192           | 512                | 0.0290    | 0.0168     | 1.73  |
| 97    | 1          | 2048        | 4096         | 8192           | 512                | 0.0328    | 0.0189     | 1.74  |
| 98    | 1          | 4096        | 4096         | 8192           | 512                | 0.0403    | 0.0210     | 1.91  |
| 99    | 1          | 8192        | 4096         | 8192           | 512                | 0.0552    | 0.0366     | 1.51  |
| 100   | 1          | 16384       | 4096         | 8192           | 512                | 0.1052    | 0.0590     | 1.78  |
| 101   | 1          | 1024        | 8192         | 8192           | 512                | 0.0491    | 0.0166     | 2.96  |
| 102   | 1          | 2048        | 8192         | 8192           | 512                | 0.0566    | 0.0214     | 2.65  |
| 103   | 1          | 4096        | 8192         | 8192           | 512                | 0.0717    | 0.0388     | 1.85  |
| 104   | 1          | 8192        | 8192         | 8192           | 512                | 0.1169    | 0.0585     | 2.00  |
| 105   | 1          | 16384       | 8192         | 8192           | 512                | 0.2268    | 0.1032     | 2.20  |
| 106   | 1          | 1024        | 14336        | 8192           | 512                | 0.0792    | 0.0196     | 4.04  |
| 107   | 1          | 2048        | 14336        | 8192           | 512                | 0.0926    | 0.0362     | 2.56  |
| 108   | 1          | 4096        | 14336        | 8192           | 512                | 0.1227    | 0.0546     | 2.25  |
| 109   | 1          | 8192        | 14336        | 8192           | 512                | 0.2279    | 0.0912     | 2.50  |
| 110   | 1          | 16384       | 14336        | 8192           | 512                | 0.3804    | 0.1650     | 2.31  |
| 111   | 1          | 1024        | 28672        | 8192           | 512                | 0.1500    | 0.0322     | 4.66  |
| 112   | 1          | 2048        | 28672        | 8192           | 512                | 0.1812    | 0.0571     | 3.18  |
| 113   | 1          | 4096        | 28672        | 8192           | 512                | 0.2819    | 0.0968     | 2.91  |
| 114   | 1          | 8192        | 28672        | 8192           | 512                | 0.4389    | 0.1693     | 2.59  |
| 115   | 1          | 16384       | 28672        | 8192           | 512                | 0.7663    | 0.3131     | 2.45  |
| 116   | 1          | 1024        | 53248        | 8192           | 512                | 0.2703    | 0.0566     | 4.77  |
| 117   | 1          | 2048        | 53248        | 8192           | 512                | 0.3595    | 0.0934     | 3.85  |
| 118   | 1          | 4096        | 53248        | 8192           | 512                | 0.5027    | 0.1674     | 3.00  |
| 119   | 1          | 8192        | 53248        | 8192           | 512                | 0.8146    | 0.2968     | 2.75  |
| 120   | 1          | 16384       | 53248        | 8192           | 512                | 1.3503    | 0.5928     | 2.28  |
