============================= test session starts ==============================
platform linux -- Python 3.12.0, pytest-8.3.5, pluggy-1.5.0 -- /home/yincao/miniconda/envs/ying-py3.12/bin/python
cachedir: .pytest_cache
benchmark: 5.1.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /home/yincao/ying/CudaPlayground
configfile: pyproject.toml
plugins: benchmark-5.1.0, anyio-4.9.0, typeguard-4.3.0
collecting ... collected 60 items

bench_quant_gemv.py::test_gemv_performance[1024-1024-1-vptq] PASSED      [  1%]
bench_quant_gemv.py::test_gemv_performance[1024-1024-1-torch] PASSED     [  3%]
bench_quant_gemv.py::test_gemv_performance[1024-2048-1-vptq] PASSED      [  5%]
bench_quant_gemv.py::test_gemv_performance[1024-2048-1-torch] PASSED     [  6%]
bench_quant_gemv.py::test_gemv_performance[1024-4096-1-vptq] PASSED      [  8%]
bench_quant_gemv.py::test_gemv_performance[1024-4096-1-torch] PASSED     [ 10%]
bench_quant_gemv.py::test_gemv_performance[1024-8192-1-vptq] PASSED      [ 11%]
bench_quant_gemv.py::test_gemv_performance[1024-8192-1-torch] PASSED     [ 13%]
bench_quant_gemv.py::test_gemv_performance[1024-16384-1-vptq] PASSED     [ 15%]
bench_quant_gemv.py::test_gemv_performance[1024-16384-1-torch] PASSED    [ 16%]
bench_quant_gemv.py::test_gemv_performance[4096-1024-1-vptq] PASSED      [ 18%]
bench_quant_gemv.py::test_gemv_performance[4096-1024-1-torch] PASSED     [ 20%]
bench_quant_gemv.py::test_gemv_performance[4096-2048-1-vptq] PASSED      [ 21%]
bench_quant_gemv.py::test_gemv_performance[4096-2048-1-torch] PASSED     [ 23%]
bench_quant_gemv.py::test_gemv_performance[4096-4096-1-vptq] PASSED      [ 25%]
bench_quant_gemv.py::test_gemv_performance[4096-4096-1-torch] PASSED     [ 26%]
bench_quant_gemv.py::test_gemv_performance[4096-8192-1-vptq] PASSED      [ 28%]
bench_quant_gemv.py::test_gemv_performance[4096-8192-1-torch] PASSED     [ 30%]
bench_quant_gemv.py::test_gemv_performance[4096-16384-1-vptq] PASSED     [ 31%]
bench_quant_gemv.py::test_gemv_performance[4096-16384-1-torch] PASSED    [ 33%]
bench_quant_gemv.py::test_gemv_performance[8192-1024-1-vptq] PASSED      [ 35%]
bench_quant_gemv.py::test_gemv_performance[8192-1024-1-torch] PASSED     [ 36%]
bench_quant_gemv.py::test_gemv_performance[8192-2048-1-vptq] PASSED      [ 38%]
bench_quant_gemv.py::test_gemv_performance[8192-2048-1-torch] PASSED     [ 40%]
bench_quant_gemv.py::test_gemv_performance[8192-4096-1-vptq] PASSED      [ 41%]
bench_quant_gemv.py::test_gemv_performance[8192-4096-1-torch] PASSED     [ 43%]
bench_quant_gemv.py::test_gemv_performance[8192-8192-1-vptq] PASSED      [ 45%]
bench_quant_gemv.py::test_gemv_performance[8192-8192-1-torch] PASSED     [ 46%]
bench_quant_gemv.py::test_gemv_performance[8192-16384-1-vptq] PASSED     [ 48%]
bench_quant_gemv.py::test_gemv_performance[8192-16384-1-torch] PASSED    [ 50%]
bench_quant_gemv.py::test_gemv_performance[14336-1024-1-vptq] PASSED     [ 51%]
bench_quant_gemv.py::test_gemv_performance[14336-1024-1-torch] PASSED    [ 53%]
bench_quant_gemv.py::test_gemv_performance[14336-2048-1-vptq] PASSED     [ 55%]
bench_quant_gemv.py::test_gemv_performance[14336-2048-1-torch] PASSED    [ 56%]
bench_quant_gemv.py::test_gemv_performance[14336-4096-1-vptq] PASSED     [ 58%]
bench_quant_gemv.py::test_gemv_performance[14336-4096-1-torch] PASSED    [ 60%]
bench_quant_gemv.py::test_gemv_performance[14336-8192-1-vptq] PASSED     [ 61%]
bench_quant_gemv.py::test_gemv_performance[14336-8192-1-torch] PASSED    [ 63%]
bench_quant_gemv.py::test_gemv_performance[14336-16384-1-vptq] PASSED    [ 65%]
bench_quant_gemv.py::test_gemv_performance[14336-16384-1-torch] PASSED   [ 66%]
bench_quant_gemv.py::test_gemv_performance[28672-1024-1-vptq] PASSED     [ 68%]
bench_quant_gemv.py::test_gemv_performance[28672-1024-1-torch] PASSED    [ 70%]
bench_quant_gemv.py::test_gemv_performance[28672-2048-1-vptq] PASSED     [ 71%]
bench_quant_gemv.py::test_gemv_performance[28672-2048-1-torch] PASSED    [ 73%]
bench_quant_gemv.py::test_gemv_performance[28672-4096-1-vptq] PASSED     [ 75%]
bench_quant_gemv.py::test_gemv_performance[28672-4096-1-torch] PASSED    [ 76%]
bench_quant_gemv.py::test_gemv_performance[28672-8192-1-vptq] PASSED     [ 78%]
bench_quant_gemv.py::test_gemv_performance[28672-8192-1-torch] PASSED    [ 80%]
bench_quant_gemv.py::test_gemv_performance[28672-16384-1-vptq] PASSED    [ 81%]
bench_quant_gemv.py::test_gemv_performance[28672-16384-1-torch] PASSED   [ 83%]
bench_quant_gemv.py::test_gemv_performance[53248-1024-1-vptq] PASSED     [ 85%]
bench_quant_gemv.py::test_gemv_performance[53248-1024-1-torch] PASSED    [ 86%]
bench_quant_gemv.py::test_gemv_performance[53248-2048-1-vptq] PASSED     [ 88%]
bench_quant_gemv.py::test_gemv_performance[53248-2048-1-torch] PASSED    [ 90%]
bench_quant_gemv.py::test_gemv_performance[53248-4096-1-vptq] PASSED     [ 91%]
bench_quant_gemv.py::test_gemv_performance[53248-4096-1-torch] PASSED    [ 93%]
bench_quant_gemv.py::test_gemv_performance[53248-8192-1-vptq] PASSED     [ 95%]
bench_quant_gemv.py::test_gemv_performance[53248-8192-1-torch] PASSED    [ 96%]
bench_quant_gemv.py::test_gemv_performance[53248-16384-1-vptq] PASSED    [ 98%]
bench_quant_gemv.py::test_gemv_performance[53248-16384-1-torch] PASSED   [100%]
Wrote benchmark data in: <_io.BufferedWriter name='benchmark/results.json'>



----------------------------------------------------------------------------------------------- benchmark: 60 tests -----------------------------------------------------------------------------------------------
Name (time in ms)                                   Min                 Max                Mean            StdDev              Median               IQR            Outliers       OPS            Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_gemv_performance[1024-1024-1-torch]         4.2888 (1.0)        4.7303 (1.0)        4.5539 (1.0)      0.1562 (7.32)       4.6036 (1.0)      0.2083 (7.19)          4;0  219.5925 (1.0)          11           1
test_gemv_performance[1024-2048-1-torch]         4.3327 (1.01)       5.2500 (1.11)       4.7797 (1.05)     0.2785 (13.05)      4.7284 (1.03)     0.4777 (16.49)        88;0  209.2164 (0.95)        206           1
test_gemv_performance[4096-1024-1-torch]         4.4401 (1.04)       5.4931 (1.16)       5.0003 (1.10)     0.2731 (12.80)      5.0639 (1.10)     0.4613 (15.93)        42;0  199.9868 (0.91)        184           1
test_gemv_performance[4096-2048-1-torch]         4.4642 (1.04)       5.4211 (1.15)       4.9274 (1.08)     0.2797 (13.11)      4.8966 (1.06)     0.4864 (16.79)        82;0  202.9456 (0.92)        182           1
test_gemv_performance[8192-1024-1-torch]         4.5173 (1.05)       5.5058 (1.16)       5.0112 (1.10)     0.2857 (13.39)      4.9878 (1.08)     0.4546 (15.69)        75;0  199.5529 (0.91)        186           1
test_gemv_performance[1024-4096-1-torch]         4.7889 (1.12)       5.8608 (1.24)       5.1496 (1.13)     0.2325 (10.90)      5.1627 (1.12)     0.3204 (11.06)        38;2  194.1882 (0.88)        103           1
test_gemv_performance[1024-8192-1-torch]         4.8379 (1.13)       6.0196 (1.27)       5.3824 (1.18)     0.2997 (14.04)      5.4038 (1.17)     0.5152 (17.79)        79;0  185.7917 (0.85)        171           1
test_gemv_performance[1024-1024-1-vptq]          5.1452 (1.20)       5.4161 (1.14)       5.3088 (1.17)     0.1143 (5.36)       5.3499 (1.16)     0.1848 (6.38)          1;0  188.3661 (0.86)          5           1
test_gemv_performance[14336-1024-1-torch]        5.1604 (1.20)       5.7167 (1.21)       5.4807 (1.20)     0.1657 (7.76)       5.4804 (1.19)     0.2798 (9.66)         75;0  182.4574 (0.83)        179           1
test_gemv_performance[8192-2048-1-torch]         5.3326 (1.24)       5.8844 (1.24)       5.7248 (1.26)     0.1578 (7.39)       5.8123 (1.26)     0.2445 (8.44)         39;0  174.6793 (0.80)        169           1
test_gemv_performance[1024-2048-1-vptq]          5.3497 (1.25)       5.8987 (1.25)       5.6223 (1.23)     0.1542 (7.23)       5.6125 (1.22)     0.1998 (6.90)         70;0  177.8646 (0.81)        171           1
test_gemv_performance[4096-4096-1-torch]         5.4180 (1.26)       6.0819 (1.29)       5.8144 (1.28)     0.1438 (6.74)       5.8825 (1.28)     0.1984 (6.85)         39;2  171.9861 (0.78)        171           1
test_gemv_performance[1024-16384-1-torch]        5.6380 (1.31)       6.2734 (1.33)       5.9210 (1.30)     0.1622 (7.60)       5.9005 (1.28)     0.2817 (9.73)         67;0  168.8918 (0.77)        158           1
test_gemv_performance[1024-4096-1-vptq]          6.1763 (1.44)       6.8137 (1.44)       6.4085 (1.41)     0.1308 (6.13)       6.3921 (1.39)     0.1516 (5.23)         45;4  156.0424 (0.71)        152           1
test_gemv_performance[1024-8192-1-vptq]          7.4978 (1.75)       8.1196 (1.72)       7.7241 (1.70)     0.1287 (6.03)       7.7067 (1.67)     0.1561 (5.39)         37;1  129.4647 (0.59)        127           1
test_gemv_performance[8192-4096-1-torch]         8.4507 (1.97)       9.0145 (1.91)       8.8345 (1.94)     0.1095 (5.13)       8.8757 (1.93)     0.0571 (1.97)        20;22  113.1926 (0.52)        111           1
test_gemv_performance[14336-2048-1-torch]        8.5150 (1.99)       9.1001 (1.92)       8.9302 (1.96)     0.1590 (7.45)       8.9954 (1.95)     0.2869 (9.91)         25;0  111.9793 (0.51)        111           1
test_gemv_performance[28672-1024-1-torch]        8.6407 (2.01)       9.1146 (1.93)       8.9914 (1.97)     0.1307 (6.13)       9.0708 (1.97)     0.1549 (5.35)         22;4  111.2169 (0.51)        111           1
test_gemv_performance[4096-8192-1-torch]         8.8176 (2.06)       9.2702 (1.96)       9.1156 (2.00)     0.1298 (6.08)       9.1617 (1.99)     0.2213 (7.64)         39;0  109.7025 (0.50)        106           1
test_gemv_performance[4096-1024-1-vptq]          9.1453 (2.13)       9.5375 (2.02)       9.4039 (2.07)     0.1189 (5.57)       9.4644 (2.06)     0.1956 (6.75)         27;0  106.3390 (0.48)        104           1
test_gemv_performance[4096-2048-1-vptq]          9.9952 (2.33)      10.2778 (2.17)      10.1887 (2.24)     0.0353 (1.65)      10.1909 (2.21)     0.0290 (1.0)          14;5   98.1481 (0.45)         98           1
test_gemv_performance[1024-16384-1-vptq]        10.3258 (2.41)      10.8295 (2.29)      10.6014 (2.33)     0.1441 (6.76)      10.6702 (2.32)     0.2584 (8.92)         34;0   94.3274 (0.43)         93           1
test_gemv_performance[4096-4096-1-vptq]         11.4027 (2.66)      11.8403 (2.50)      11.7184 (2.57)     0.1216 (5.70)      11.7822 (2.56)     0.1663 (5.74)         20;0   85.3359 (0.39)         87           1
test_gemv_performance[53248-1024-1-torch]       11.6019 (2.71)      12.2041 (2.58)      11.8549 (2.60)     0.1555 (7.29)      11.8039 (2.56)     0.3004 (10.37)        41;0   84.3533 (0.38)         80           1
test_gemv_performance[14336-4096-1-torch]       12.8844 (3.00)      13.3913 (2.83)      13.2018 (2.90)     0.1067 (5.00)      13.2354 (2.87)     0.0547 (1.89)        14;13   75.7471 (0.34)         75           1
test_gemv_performance[28672-2048-1-torch]       13.0256 (3.04)      13.5605 (2.87)      13.3652 (2.93)     0.1368 (6.41)      13.4157 (2.91)     0.2202 (7.60)         22;0   74.8214 (0.34)         74           1
test_gemv_performance[8192-8192-1-torch]        13.5458 (3.16)      13.9213 (2.94)      13.7755 (3.02)     0.1099 (5.15)      13.8299 (3.00)     0.1788 (6.17)         23;0   72.5926 (0.33)         72           1
test_gemv_performance[4096-16384-1-torch]       13.8180 (3.22)      14.3736 (3.04)      14.0440 (3.08)     0.1415 (6.63)      14.0127 (3.04)     0.2677 (9.24)         32;0   71.2050 (0.32)         71           1
test_gemv_performance[4096-8192-1-vptq]         14.4533 (3.37)      14.9586 (3.16)      14.7179 (3.23)     0.1345 (6.30)      14.7429 (3.20)     0.2449 (8.46)         27;0   67.9445 (0.31)         68           1
test_gemv_performance[8192-1024-1-vptq]         14.6572 (3.42)      15.1152 (3.20)      14.9418 (3.28)     0.1345 (6.30)      15.0186 (3.26)     0.2245 (7.75)         21;0   66.9265 (0.30)         67           1
test_gemv_performance[8192-2048-1-vptq]         16.1172 (3.76)      16.5098 (3.49)      16.3432 (3.59)     0.1219 (5.71)      16.3490 (3.55)     0.2057 (7.10)         28;0   61.1874 (0.28)         62           1
test_gemv_performance[53248-2048-1-torch]       18.8195 (4.39)      19.2762 (4.08)      19.0299 (4.18)     0.1354 (6.34)      18.9976 (4.13)     0.2506 (8.65)         23;0   52.5488 (0.24)         52           1
test_gemv_performance[8192-4096-1-vptq]         19.1289 (4.46)      19.5683 (4.14)      19.4009 (4.26)     0.1080 (5.06)      19.4450 (4.22)     0.1515 (5.23)         13;0   51.5440 (0.23)         51           1
test_gemv_performance[14336-8192-1-torch]       20.7969 (4.85)      21.3087 (4.50)      21.0773 (4.63)     0.1381 (6.47)      21.0744 (4.58)     0.2386 (8.24)         18;0   47.4445 (0.22)         48           1
test_gemv_performance[28672-4096-1-torch]       20.8560 (4.86)      21.2985 (4.50)      21.0735 (4.63)     0.1252 (5.87)      21.0503 (4.57)     0.1862 (6.43)         20;0   47.4529 (0.22)         48           1
test_gemv_performance[4096-16384-1-vptq]        21.5848 (5.03)      22.0081 (4.65)      21.8344 (4.79)     0.1464 (6.86)      21.8245 (4.74)     0.2883 (9.95)         25;0   45.7993 (0.21)         46           1
test_gemv_performance[14336-1024-1-vptq]        22.8036 (5.32)      23.2668 (4.92)      23.0624 (5.06)     0.1070 (5.02)      23.1004 (5.02)     0.1347 (4.65)         12;0   43.3606 (0.20)         44           1
test_gemv_performance[8192-16384-1-torch]       23.4616 (5.47)      23.9065 (5.05)      23.6942 (5.20)     0.1454 (6.81)      23.6754 (5.14)     0.2996 (10.34)        24;0   42.2043 (0.19)         42           1
test_gemv_performance[14336-2048-1-vptq]        25.2106 (5.88)      25.6279 (5.42)      25.4981 (5.60)     0.1111 (5.20)      25.5358 (5.55)     0.1299 (4.48)         10;1   39.2186 (0.18)         40           1
test_gemv_performance[8192-8192-1-vptq]         25.3715 (5.92)      25.7780 (5.45)      25.6374 (5.63)     0.1132 (5.30)      25.6664 (5.58)     0.1912 (6.60)         15;0   39.0055 (0.18)         40           1
test_gemv_performance[14336-4096-1-vptq]        30.3584 (7.08)      30.7049 (6.49)      30.5795 (6.72)     0.1183 (5.55)      30.6372 (6.65)     0.1931 (6.67)          9;0   32.7017 (0.15)         33           1
test_gemv_performance[53248-4096-1-torch]       33.3085 (7.77)      33.7061 (7.13)      33.4997 (7.36)     0.1367 (6.41)      33.5026 (7.28)     0.2652 (9.15)         15;0   29.8510 (0.14)         30           1
test_gemv_performance[28672-8192-1-torch]       37.5043 (8.74)      37.8919 (8.01)      37.6933 (8.28)     0.1204 (5.64)      37.7257 (8.19)     0.1774 (6.12)         11;0   26.5299 (0.12)         27           1
test_gemv_performance[14336-16384-1-torch]      37.8233 (8.82)      38.1748 (8.07)      38.0164 (8.35)     0.1073 (5.03)      38.0358 (8.26)     0.1705 (5.89)         10;0   26.3044 (0.12)         27           1
test_gemv_performance[28672-1024-1-vptq]        41.4490 (9.66)      41.7934 (8.84)      41.6716 (9.15)     0.1082 (5.07)      41.7134 (9.06)     0.1541 (5.32)          7;0   23.9972 (0.11)         24           1
test_gemv_performance[28672-2048-1-vptq]        46.0052 (10.73)     46.4157 (9.81)      46.2657 (10.16)    0.1082 (5.07)      46.2697 (10.05)    0.1120 (3.87)          7;2   21.6143 (0.10)         22           1
test_gemv_performance[14336-8192-1-vptq]        48.0036 (11.19)     48.3582 (10.22)     48.2090 (10.59)    0.1123 (5.26)      48.2162 (10.47)    0.1819 (6.28)          9;0   20.7430 (0.09)         21           1
test_gemv_performance[8192-16384-1-vptq]        48.2016 (11.24)     48.6075 (10.28)     48.4130 (10.63)    0.1320 (6.18)      48.4150 (10.52)    0.2394 (8.27)          9;0   20.6556 (0.09)         21           1
test_gemv_performance[28672-4096-1-vptq]        60.4610 (14.10)     60.8658 (12.87)     60.6500 (13.32)    0.1225 (5.74)      60.6171 (13.17)    0.2100 (7.25)          7;0   16.4880 (0.08)         17           1
test_gemv_performance[53248-8192-1-torch]       68.3215 (15.93)     68.7566 (14.54)     68.5067 (15.04)    0.1180 (5.53)      68.4975 (14.88)    0.1134 (3.92)          5;2   14.5971 (0.07)         15           1
test_gemv_performance[28672-16384-1-torch]      69.3971 (16.18)     69.7622 (14.75)     69.5848 (15.28)    0.1158 (5.43)      69.5729 (15.11)    0.2037 (7.03)          5;0   14.3709 (0.07)         15           1
test_gemv_performance[53248-1024-1-vptq]        73.2773 (17.09)     73.7043 (15.58)     73.5310 (16.15)    0.1223 (5.73)      73.5233 (15.97)    0.1925 (6.65)          5;0   13.5997 (0.06)         14           1
test_gemv_performance[14336-16384-1-vptq]       79.5246 (18.54)     79.8214 (16.87)     79.6808 (17.50)    0.0996 (4.67)      79.7220 (17.32)    0.1420 (4.90)          5;0   12.5501 (0.06)         13           1
test_gemv_performance[53248-2048-1-vptq]        82.5156 (19.24)     82.9342 (17.53)     82.7110 (18.16)    0.1185 (5.55)      82.7103 (17.97)    0.1961 (6.77)          3;0   12.0903 (0.06)         13           1
test_gemv_performance[28672-8192-1-vptq]        90.9667 (21.21)     91.2447 (19.29)     91.0956 (20.00)    0.0843 (3.95)      91.0768 (19.78)    0.1226 (4.23)          4;0   10.9775 (0.05)         11           1
test_gemv_performance[53248-4096-1-vptq]       108.5712 (25.32)    108.9898 (23.04)    108.7014 (23.87)    0.1199 (5.62)     108.6702 (23.61)    0.1473 (5.08)          2;1    9.1995 (0.04)         10           1
test_gemv_performance[53248-16384-1-torch]     130.3495 (30.39)    130.6675 (27.62)    130.4654 (28.65)    0.1059 (4.96)     130.4484 (28.34)    0.1418 (4.90)          3;0    7.6649 (0.03)          8           1
test_gemv_performance[28672-16384-1-vptq]      154.1363 (35.94)    154.4613 (32.65)    154.2799 (33.88)    0.1167 (5.47)     154.3043 (33.52)    0.1715 (5.92)          2;0    6.4817 (0.03)          7           1
test_gemv_performance[53248-8192-1-vptq]       165.4607 (38.58)    165.5164 (34.99)    165.4840 (36.34)    0.0213 (1.0)      165.4776 (35.94)    0.0330 (1.14)          3;0    6.0429 (0.03)          7           1
test_gemv_performance[53248-16384-1-vptq]      279.9540 (65.28)    280.1227 (59.22)    280.0411 (61.49)    0.0632 (2.96)     280.0284 (60.83)    0.0822 (2.84)          2;0    3.5709 (0.02)          5           1
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Legend:
  Outliers: 1 Standard Deviation from Mean; 1.5 IQR (InterQuartile Range) from 1st Quartile and 3rd Quartile.
  OPS: Operations Per Second, computed as 1 / Mean
======================== 60 passed in 69.45s (0:01:09) =========================
